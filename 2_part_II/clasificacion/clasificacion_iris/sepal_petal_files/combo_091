YUI.add("photostream-models",(function(e,t){function r(e){r.superclass.constructor.call(this,e)}e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-people-getPhotos"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"photostream"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t,r=this.appContext.getViewer(),n=this.getValue(e,"normalizedId");return r&&r.nsid===n?this.intlMessage({intlName:"models.YOUR_PHOTOSTREAM"}):(t=this.getValue(e,"owner"))?this.intlMessage({intlName:"models.USER_PHOTOSTREAM",name:t.getValue("displayname")}):this.intlMessage({intlName:"models.PHOTOSTREAM"})}},pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-photos-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),r=this.getValue(e,"normalizedId");return"/photos/"+(t?t.getValue("pathAlias"):r)+"/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,defaultFn:function(e){var t,n=r.splitCompoundId(e);return n.orderBy?(t=n.orderBy,n.viewAs?t+="-"+n.viewAs:"dateposted"===n.orderBy&&(t="photostream")):t="photostream",t}}}},{buildCompoundId:function(e,t,r){var n=e;return t&&(n+="-"+t),r&&(t||(n+="-dateposted"),n+="-"+r),n},splitCompoundId:function(e){var t=e.split("-");return{nsid:t[0],orderBy:t[1],viewAs:t[2]}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getContext-fetcher","flickr-people-getPhotos-fetcher","photo-model-helper"],langBundles:["models"]});YUI.add("person-model-helper",(function(e){e.PersonModelHelper={attributes:{pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return e}},username:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},nsid:{readOnly:!0,defaultFn:function(e){return e}},url:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){return"/photos/"+this.getValue(e,"pathAlias")+"/"}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}}}}}),"@VERSION@",{requires:[]});YUI.add("person-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,url:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,buddyicon:{},isPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proBadge:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isMinor:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proExpireDate:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},isDeleted:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isAdFree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isNoAds:{derivedBy:["isPro","isAdFree"],readOnly:!0,getter:function(e,t){var r=this.getValue(t,"isPro"),n=this.getValue(t,"isAdFree");return r||n}},hasStats:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasAdfree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has1TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has2TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasUnlimitedStorage:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeStandardShipping:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeEducationalResources:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},dateCreated:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},location:{defaultFn:function(){return""}},expiringPartner:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultFn:function(){return!1}},uploadCount:{defaultValue:null},uploadLimit:{defaultValue:null},uploadLimitStatus:{defaultValue:null},isCognitoUser:{defaultValue:null},hasAuthorizedMobile:{defaultValue:null},hasInvalidEmail:{defaultValue:!1},subscription:{defaultValue:{isPastDue:!1,isPro:!1,isClosed:!1}},contactsCacheUrl:{defaultValue:!1}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","attribute-helpers","person-model-helper"]});YUI.add("flickr-people-getInfo-fetcher",(function(e,r){"use strict";var s=new e.SubscriptionsHelper;e.namespace("ModelFetchers")["flickr-people-getInfo"]={run:function(s,o){var t=this,i=o.getViewer();return i&&i.signedIn&&(s.id===i.nsid||s.nsid===i.nsid)&&(s.storage=1),new e.FlickrPromise({apiResponse:o.callAPI("flickr.people.getInfo",this._processParams(s,o),!0),personModelRegistry:o.getModelRegistry("person-models"),personRelationshipModelRegistry:o.getModelRegistry("person-relationship-models"),personProfileModelRegistry:o.getModelRegistry("person-profile-models"),personPreferencesModelRegistry:o.getModelRegistry("person-preferences-models"),personGroupsModelRegistry:o.getModelRegistry("person-groups-models"),personNotificationsModelRegistry:o.getModelRegistry("person-notifications-models"),photostreamModelRegistry:o.getModelRegistry("photostream-models")}).then((function(e){return t._processResponse(e,s,o)}),e.FetcherErrorLogger(r))},_processParams:function(r,s){var o={datecreate:1};if(o.extras=e.APIHelper.request.getRebootPeopleExtras(),YUI.Env.isServer&&r.id===s.request.probableUser?(o.storage=1,o.extras+=", classic_user_id, timezone_dst, unified_search_view_pref, photostream_view_order_pref, photostream_view_as_pref, album_view_layout, download_pref, products_features, subscriptions",o.extras+=", is_minor"):s.getViewer().signedIn&&r.id===s.getViewer().nsid&&(o.extras+=", products_features, subscriptions"),r.extras&&"string"==typeof r.extras&&r.extras.length>0&&(o.extras=o.extras+","+r.extras),r.id)o.user_id=r.id;else{if(!r.pathAlias)throw new Error("`fetch` is missing required params.");o.path_alias=r.pathAlias}return r.storage&&(o.storage=r.storage),o.extras||(o.extras=""),o.extras+=", has_stats",o},_processResponse:function(r,o,t){var i,a,n,p=r.apiResponse,d=r.personModelRegistry,l=r.personRelationshipModelRegistry,c=r.personProfileModelRegistry,u=r.personPreferencesModelRegistry,g=r.personGroupsModelRegistry,m=r.personNotificationsModelRegistry,h=r.photostreamModelRegistry,f=p.person,M=t.getViewer(),_=f.id,y=M&&M.signedIn&&_===M.nsid;return n={id:_,pathAlias:f.pathAlias,username:f.username&&f.username._content,realname:f.realname&&f.realname._content,buddyicon:e.APIHelper.response.removeProtocolFromURL(f.iconurls),isAdFree:f.isAdFree,isPro:f.ispro,proBadge:f.proBadge,isMinor:f.isMinor,hasStats:f.hasStats,location:f.location&&f.location._content,hasAdfree:f.hasAdfree,has1TB:f.has1TB,has2TB:f.has2TB,hasUnlimitedStorage:f.hasUnlimitedStorage,hasFreeStandardShipping:f.hasFreeStandardShipping,hasFreeEducationalResources:f.hasFreeEducationalResources,dateCreated:f.datecreate._content,expiringPartner:f.expiringPartner},f.ispro&&(n.proExpireDate=f.expire),y&&(n.uploadLimit=f.uploadLimit,n.uploadCount=f.uploadCount,n.uploadLimitStatus=f.uploadLimitStatus,n.isCognitoUser=f.isCognitoUser,n.hasInvalidEmail=!1,f.email&&(!f.email||f.email._content&&""!==f.email._content)?f.email._content&&-1===f.email._content.indexOf("@")?n.hasInvalidEmail=!0:n.hasInvalidEmail=!1:n.hasInvalidEmail=!0,n.isPro&&(n.subscription=s.parseEffectiveSubscriptionData(!0,p.effectiveSubscriptions)),f.contactsCacheUrl&&(n.contactsCacheUrl=f.contactsCacheUrl)),d.addOrUpdate(n),m.addOrUpdate({id:_,unreadFlickrMailCount:f.unreadMessages?f.unreadMessages.content:0}),l.addOrUpdate({id:_,pathAlias:f.pathAlias,isContact:f.contact,isFriend:f.friend,isFamily:f.family,isIgnored:f.ignored,isIgnoredBy:f.ignoredby,isRevContact:f.revcontact,isRevFriend:f.revfriend,isRevFamily:f.revfamily}),y&&(a={id:_},f.safeSearch&&(a.safeSearch=(f.safeSearch||1)-1),f.viewPrefs&&(a.unifiedSearchViewPref=f.viewPrefs.unifiedSearchViewPref,a.photostreamViewOrderPref=f.viewPrefs.photostreamViewOrderPref,a.photostreamViewAsPref=f.viewPrefs.photostreamViewAsPref,a.albumViewLayoutPref=f.viewPrefs.albumViewLayout,a.galleryViewLayoutPref=f.viewPrefs.galleriesViewLayoutPref),u.exists(_)?u.setValues(_,a):u.add(a)),i={id:_,coverPhotoUrls:e.APIHelper.response.removeProtocolFromURL(f.coverphoto_url),photoCount:f.photos.count.content,location:f.location?f.location.content:null,arrPhotoCount:f.all_rights_reserved_photos_count},f.storage&&(i.storageUsed=f.storage.used.content,i.storageTotal=f.storage.total.content),f.unreadMessages&&(i.unreadMessages=f.unreadMessages.content),c.addOrUpdate(i),g.addOrUpdate({id:_,memberCount:f.groupMemberships?f.groupMemberships.member:null,moderatorCount:f.groupMemberships?f.groupMemberships.moderator:null,adminCount:f.groupMemberships?f.groupMemberships.admin:null,invitedCount:f.groupMemberships?f.groupMemberships.invited:null}),h.addOrUpdate({id:_,pathAlias:f.pathAlias,owner:d.proxy(_),totalItems:f.photos.count&&f.photos.count.content}),f}}}),"@VERSION@",{requires:["flickr-promise","subscriptions-helper"],optional:["person-models","person-relationship-models","person-preferences-models","person-profile-models","person-groups-models","photostream-models","api-helper"]});YUI.add("person-relationship-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,i){var r=[],n={};return e.Lang.isObject(i,!0)&&(n.user_id=t,n.friend=this.getValue(t,"isFriend"),n.family=this.getValue(t,"isFamily"),"isContact"in i&&(i.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(n,this.appContext))),("isFriend"in i||"isFamily"in i)&&("isFriend"in i&&(n.friend=i.isFriend.newVal),"isFamily"in i&&(n.family=i.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(n,this.appContext))),"isIgnored"in i&&(!0===i.isIgnored.newVal?r.push(e.ModelUpdaters["flickr-contacts-block"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(n,this.appContext)))),e.Promise.all(r)}},toggleFollowing:function(e){this.getValue(e,"isContact")?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){this.getValue(e,"isFriend")?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){this.getValue(e,"isFamily")?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){this.getValue(e,"isIgnored")?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var i=this.appContext.getViewer();return!!i&&this.getValue(t,"nsid")===i.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});YUI.add("banner-helper",(function(e,i){var n=require("hermes-core/flog")(i),r=(e.mix({langBundles:["featured-banner"]},e.Localizable),new e.SubscriptionsHelper);e.BannerHelper=function(i){var o=this,t=[],s=[],a={loginMigration:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){var e=!1,n=i.getViewer().isCognitoUser;return i.getViewer().signedIn&&!n&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)&&(e=!0),e},viewName:"login-migration-banner-view",viewConfig:{}}},pastDue:function(n){var r;return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){var n=i.getViewer();return n.signedIn&&n.isPro?i.getModel("person-models",n.nsid).then((function(e){var i=e.getValue("subscription");r=i.isPastDue})):(r=!1,e.Promise.resolve())},canShowBanner:function(){var e=!1;return i.getViewer().signedIn&&i.getViewer().isPro&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)&&r&&(e=!0),e},viewName:"past-due-banner-view",viewConfig:{}}},migrateSubscription:function(n){var o="priority"in n?n.priority:Number.MAX_VALUE,t="placement"in n?n.placement:"header",s=!1,a=!1;return{priority:o,placement:t,load:function(){var n=i.getViewer();return n.signedIn&&n.isPro?i.getModel("effective-subscriptions-models",n.nsid).then(function(n){if(n&&n.getValue("length")>0){var o=r.getEligibleSubscription(n,!0);o&&(s=o.isBraintreeSubscription||o.isDigitalRiverSubscription&&i.flipper.isFlipped("enable-dr-paypal-migrate-banner"),a=o.nextBillingDate&&o.nextBillingDate.isBefore&&o.nextBillingDate.isBefore(e.moment().add(15,"days")))}}.bind(this)):(s=!1,e.Promise.resolve())},canShowBanner:function(){var n=!1;return i.getViewer().signedIn&&i.getViewer().isPro&&s&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)&&(!i.getCookie(e.config.flickr.banners.dismiss_braintree_migration_banner_name)||i.getCookie(e.config.flickr.banners.dismiss_braintree_migration_banner_name)&&a)&&(n=!0),n},viewName:"subscription-migrate-banner-view",viewConfig:{}}},cookie:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"footer",load:function(){return e.Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_cookie_banner_name)&&!i.requiresCookieConsent},viewName:"cookie-banner-view",viewConfig:{}}},cookieConsent:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"footer",load:function(){return e.Promise.resolve()},canShowBanner:function(){return i.flipper.isFlipped("enable-cookie-consent-execution-hermes")&&i.requiresCookieConsent},viewName:"trustarc-consent-manager-view",viewConfig:{}}},uploadLimit:function(n){var r;return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return i.getViewer().signedIn?i.getModel("person-profile-models",i.getViewer().nsid).then((function(e){r=e})):e.Promise.resolve()},canShowBanner:function(){var n=!i.getCookie(e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isOverARRLimit(r,i)&&"products-flickrpro-route"!==i.routeConfig.module,o=!i.getCookie(e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isAtUploadLimit(r,i),t=!i.getCookie(e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isNearUploadLimit(r,i);return i.flipper.isFlipped("enable-upload-limit-messages")&&i.getViewer().signedIn&&"pro-checkout-route"!==i.routeConfig.module&&(n||o||t)},viewName:"upload-limit-banner-view",viewConfig:{}}},tosMarketing:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return"feed-new-page-view"===i.flapp.get("activeView").name&&!i.getCookie(e.config.flickr.banners.dismiss_tos_marketing_banner_name)},viewName:"tos-marketing-banner-view",viewConfig:{},startTime:new Date("2022-03-17T16:00:00.000Z")}},proForExploredBanner:function(n){var r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=!1,s=i.flipper.getValue("enable-free-pro-explore-exp"),a=["A","B"],p=["B","F"];return{priority:r,placement:o,load:function(){var n=i.getViewer();return n.signedIn?i.getModel("effective-subscriptions-models",n.nsid).then((function(e){var i=n.isPro;i&&e&&e.getValue("length")>0?t=!1:(i&&s&&p.indexOf(s)>-1&&a.indexOf(s)>-1&&(t=!0),!i&&s&&p.indexOf(s)>-1&&!(a.indexOf(s)>-1)&&(t=!0),!i&&s&&p.indexOf(s)>-1&&a.indexOf(s)>-1&&(t=!0))})):(t=!1,e.Promise.resolve())},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_pro_explore_experiment)&&t&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)},viewName:"pro-explored-users-banner-view",viewConfig:{}}},exploreTakeover:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_explore_takeover_banner)&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)},viewName:"explore-takeover-banner-view",viewConfig:{},startTime:new Date("2022-03-31T04:00:00.000Z"),endTime:new Date("2022-04-01T03:55:00.000Z")}},targetedConversionMonth:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)&&!i.getCookie(e.config.flickr.banners.dismiss_targeted_conversion_month_banner)&&("old_tc_experiment"===i.flipper.getValue("enable-targeted-conversion")||"new_tc_experiment"===i.flipper.getValue("enable-targeted-conversion"))},viewName:"targeted-conversion-month-banner-view",viewConfig:{},startTime:new Date("2022-04-17T19:00:00.000Z"),endTime:new Date("2022-04-30T19:00:00.000Z")}},targetedConversion2Year:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)&&!i.getCookie(e.config.flickr.banners.dismiss_targeted_conversion_2y_banner)&&"two_year_tc_experiment"===i.flipper.getValue("enable-targeted-conversion")},viewName:"targeted-conversion-2y-banner-view",viewConfig:{},startTime:new Date("2022-04-17T19:00:00.000Z"),endTime:new Date("2022-04-30T19:00:00.000Z")}},noNonSafe:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return"feed-new-page-view"===i.flapp.get("activeView").name&&!i.getCookie(e.config.flickr.banners.dismiss_no_nonsafe_banner_name)&&!i.getViewer().isPro&&"en-us"===i.lang.toLowerCase()},viewName:"no-nonsafe-banner-view",viewConfig:{},startTime:new Date("2022-04-19T16:00:00.000Z")}}};function p(){s=t.sort((function(e,i){return e.priority-i.priority}))}function l(e){var i,n,r=s.find((function(i,n){var r=void 0===e||i.placement===e,o=new Date,t=o<i.startTime||o>i.endTime;if(r&&!t&&i.canShowBanner())return!0}));if(r)return i=t.indexOf(r),-1!==(n=i)&&(t.splice(n,1),p()),r}return this.loadBanners=function(i){var r;return t=[],s=[],r=i.map((function(i){return(function(i){var r=new a[i.type]({priority:i.priority,placement:i.placement});return r?r.load().then((function(){!(function(e){t.push(e),p()})(r)})).catch((function(e){n.error("Failed to load and register banner.",{err:e})})):e.Promise.resolve()})(i)})),e.Promise.all(r)},this.getBanners=function(e){var i=[];return e.forEach((function(e){var n=l(e);n&&i.push(n)})),i},this.getQueue=function(){return s},this.typeObjects=a,this.renderBannerView=function(e){return(function(e){return i.getView(e.viewName,e.viewConfig).then((function(e){var n;return i.getView("banner-view",{subview:e}).then((function(e){return(n=e).initialize()})).then((function(){return n}))}))})(e).then((function(i){o.fire("renderBanner",{placement:e.placement,bannerView:i})}))},this},e.augment(e.BannerHelper,e.EventTarget)}),"@VERSION@",{requires:["banner-view","event-custom","effective-subscriptions-models","person-models","subscriptions-helper","moment"]});YUI.add("storage-helper",(function(e){e.StorageHelper={setItem:function(t,i,n){var o=n?"sessionStorage":"localStorage";if(e.config.win)try{e.config.win[o][t]=i}catch(e){}},getItem:function(t,i){var n,o=i?"sessionStorage":"localStorage";if(e.config.win)try{n=e.config.win[o][t]}catch(e){}return n},remove:function(t,i){var n=i?"sessionStorage":"localStorage";if(e.config.win)try{e.config.win[n].removeItem(t)}catch(e){}},hasEntries:function(t,i){var n=i?"sessionStorage":"localStorage",o=!1;if(e.config.win)try{o=void 0!==e.config.win[n][t]}catch(e){}return o},isLocalStorageAvailable:function(){var t="checkLSCompat",i=!1;try{e.config.win.localStorage[t]="checkLSCompatValue",e.config.win.localStorage.removeItem(t),i=!0}catch(e){i=!1}return i}},e.Storage={Instance:{_cache:{},_hasSessionStorage:!0,_clientIdKey:"",getClientIdKey:function(){return this._clientIdKey||(this._clientIdKey=e.config.win.appContext.clientId+"_"),this._clientIdKey},get:function(t){var i,n;try{t=t||"",i=this.getClientIdKey()+t,n=this._hasSessionStorage?e.config.win.sessionStorage.getItem(i):this._cache[i]}catch(e){this._hasSessionStorage=!1}return n},set:function(t,i){var n;try{t&&(n=this.getClientIdKey()+t,this._hasSessionStorage?e.config.win.sessionStorage.setItem(n,i):this._cache[n]=i)}catch(e){this._cache[n]=i,this._hasSessionStorage=!1}},has:function(t){var i,n=!1;try{i=this.getClientIdKey()+t,n=this._hasSessionStorage?!!e.config.win.sessionStorage.getItem(i):!!this._cache[i]}catch(e){this._hasSessionStorage=!1}return n},remove:function(t){var i;try{t=t||"",i=this.getClientIdKey()+t,this._hasSessionStorage?e.config.win.sessionStorage.removeItem(i):this._cache[i]=void 0}catch(e){this._hasSessionStorage=!1}},clear:function(){this.clearByKey(this.getClientIdKey())},clearByKey:function(t){var i,n,o,s=[];try{if(t)if(this._hasSessionStorage){for(i=0,o=e.config.win.sessionStorage.length;i<o;i++)(n=e.config.win.sessionStorage.key(i))&&0===n.indexOf(t)&&s.push(n);for(i=0,o=s.length;i<o;i++)e.config.win.sessionStorage.removeItem(s[i])}else for(e.Object.each(this._cache,(function(e,i){0===i.indexOf(t)&&s.push(i)})),i=0,o=s.length;i<o;i++)this._cache[s[i]]=void 0}catch(e){this._hasSessionStorage=!1}}}}}),"@VERSION@",{requires:[]});YUI.add("cookie-catcher",(function(e,o){"use strict";var n=require("hermes-core/flog")(o);function t(o,n){this.cookieLevelBuckets=n,this.appContext=o,this.expireTime=new Date((new Date).getTime()+864e5*e.config.flickr.cookie_consent.consent_context_expiration_days),this.cookieConsentEnabled=this.appContext.flipper.isFlipped("enable-cookie-consent-execution-hermes")}t.prototype.getCookieLevel=function(e){return-1!==this.cookieLevelBuckets.required.indexOf(e)?0:-1!==this.cookieLevelBuckets.functional.indexOf(e)?1:-1!==this.cookieLevelBuckets.advertising.indexOf(e)?2:null},t.prototype.setCookieIfAllowed=function(o,n,t){if(this.cookieConsentEnabled&&this.appContext.requiresCookieConsent){var i=this.getCookieLevel(o),c=this.appContext.cookieConsentContext?this.appContext.cookieConsentContext.info.cookieBlock.level:0;(null===i||i<=c&&!YUI.Env.isServer)&&e.Cookie.set(o,n,t)}else e.Cookie.set(o,n,t)},t.prototype.getCookieConsentContext=function(){var o=this.appContext.getCookie(e.config.flickr.cookie_consent.consent_context_name),n={};if(n=this.appContext.flipper.isFlipped("enable-geoblock-cookie-consent")?{needsConsent:0,managed:0,changed:0,info:{cookieBlock:{level:0,blockRan:0}}}:{managed:0,changed:0,info:{cookieBlock:{level:0,blockRan:0}}},o)try{n=JSON.parse(o)}catch(o){this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(n),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime})}else this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(n),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime});return n},t.prototype.updateConsentContext=function(o){var t=this.appContext.cookieConsentContext;t.info.cookieBlock.level!==o&&(t.changed=1,t.info.cookieBlock.level=o,this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(t),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime}),e.Snowplough?e.Snowplough.sendStructuredEvent({category:"cookie_consent",action:"consent_update",value:o+".0"}):n.error("Missing Y.Snowplough in CookieCatcher.prototype.updateConsentContext"),console.log("cd refresh"),e.config.win.location.reload())},t.prototype.handleConsentManagerChoice=function(){var e;try{(e=window.truste.cma.callApi("getConsentDecision","flickr.com"))&&e.consentDecision&&Number.isInteger(e.consentDecision)&&this.updateConsentContext(e.consentDecision-1)}catch(e){console.log(e)}},e.namespace("CookieCatcher"),e.CookieCatcher=t}),"@VERSION@",{requires:["cookie","io-base","json-parse","storage-helper","murmurhash","url"]});YUI.add("stacking-overlay-manager",(function(e,i){var n=require("hermes-core/flog")(i);e.StackingOverlayManager=function(i){var s,o,r=[],t={},a={push:function(n,a){var l,d,c=Object.assign({id:e.guid(),view:void 0,overlayClassList:"",hideOverlay:!1,dismissOnOverlayClick:!0,dismissOnEsc:!0,ignorePointerEvents:!1,disableBodyScroll:!0,popBeforePushOther:!1},n),v=e.one("#stacking-overlay-container"),h=this.findFirstPopBeforePushOverlay();return h&&this.pop(h.id),v.setStyles({display:"block"}),r.push(c),(l=e.Node.create('<div class="fluid-modal-overlay"><div class="balls"></div></div>')).addClass("fluid-modal-overlay"),c.overlayClassList&&l.addClass(c.overlayClassList),c.hideOverlay&&l.addClass("transparent"),c.ignorePointerEvents&&l.addClass("invisible"),v.append(l),d=l.on("click",this.handleClick.bind(this)),t[c.id]={overlay:c,node:l,clickHandler:d},c.disableBodyScroll&&e.one("body").setStyles({overflow:"hidden"}),s||(s=e.one("body").on("keyup",this.handleKeyPress.bind(this))),o||(o=i.flapp.on("activeViewChange",this.handleActiveViewChange.bind(this))),c.id},pop:function(i){var n=this;if(i){var t=r.length-1;r.find((function(e,n){return t=n,e.id===i}))&&r.slice(t,r.length).reverse().forEach((function(i,s){i.isPopped||(i.isPopped=!0,n.closeView(i),n.findFirstDisableBodyScrollOverlay()===i&&e.one("body").setStyles({overflow:"visible"}),r.pop(),n.deleteOverlay(i))}))}r.length<=0&&(e.one("#stacking-overlay-container").setStyles({display:"none"}),s&&(s.detach(),s=void 0),o&&(o.detach(),o=void 0))},deleteOverlay:function(e){var i=t[e.id];i&&(i.clickHandler.detach(),i.node.remove(),delete t[e.id])},handleClick:function(e){var i=e.target,n=r.find((function(e){return t[e.id].node===i}));n.dismissOnOverlayClick&&this.pop(n.id)},handleKeyPress:function(e){if(27===e.keyCode){var i=this.findLastDismissOnEscOverlay();i&&this.pop(i.id)}},placeViewAfterOverlay:function(e){var i=t[e];i&&i.overlay.view&&i.node.insert(i.overlay.view.get("container"),"after")},findLastDismissOnEscOverlay:function(){return r.slice().reverse().find((function(e){return e.dismissOnEsc}))},findFirstDisableBodyScrollOverlay:function(){return r.find((function(e){return e.disableBodyScroll}))},findFirstPopBeforePushOverlay:function(){return r.find((function(e){return e.popBeforePushOther}))},closeView:function(e){e&&e.view&&(e.view.close?e.view.close():(n.warn("The overlay associated with the view "+e.view.name+" was popped, but the view has no close function. Consider implementing one."),e.view.destroy({remove:!0})))},handleActiveViewChange:function(e){this.popAll()},popAll:function(){var e=r.length>0?r[0]:void 0;e&&this.pop(e.id)},hasOverlay:function(){return r.length>0}};return e.augment(a,e.EventTarget),a}}),"@VERSION@",{requires:["event-custom"],langBundles:["common"]});