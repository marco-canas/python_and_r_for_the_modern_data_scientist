YUI.add("hermes-template-fluid-share-panel-error",(function(e,a){var n=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,n,r,l){var s,t=null!=a?a:e.nullContext||{},i=e.hooks.helperMissing,o=e.escapeExpression,c=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="share-panel-body cancel-share">\n\t<div class="cancel-message">\n\t\t'+o("function"==typeof(s=null!=(s=c(n,"errorMessage")||(null!=a?c(a,"errorMessage"):a))?s:i)?s.call(t,{name:"errorMessage",hash:{},data:l,loc:{start:{line:3,column:2},end:{line:3,column:18}}}):s)+'\n\t</div>\n\n\t<button class="done-sharing mini">'+o((c(n,"intlHTMLMessage")||a&&c(a,"intlHTMLMessage")||i).call(t,{name:"intlHTMLMessage",hash:{intlName:"common.CANCEL"},data:l,loc:{start:{line:6,column:35},end:{line:6,column:79}}}))+"</button>\n</div>"},useData:!0}),r={};e.Array.each([],(function(a){var n=e.Template.get("hermes/"+a);n&&(r[a]=n)})),e.Template.register("hermes/fluid-share-panel-error",(function(a,l){return(l=l||{}).partials=l.partials?e.merge(r,l.partials):r,n(a,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-fluid-share-old-html-embed-code",(function(l,e){var a=l.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(l,e,a,n,t){var i,o=null!=e?e:l.nullContext||{},r=l.hooks.helperMissing,m="function",u=l.escapeExpression,c=l.lookupProperty||function(l,e){if(Object.prototype.hasOwnProperty.call(l,e))return l[e]};return'<a href="'+u(typeof(i=null!=(i=c(a,"embedLink")||(null!=e?c(e,"embedLink"):e))?i:r)===m?i.call(o,{name:"embedLink",hash:{},data:t,loc:{start:{line:1,column:9},end:{line:1,column:22}}}):i)+'" title="'+u(typeof(i=null!=(i=c(a,"title")||(null!=e?c(e,"title"):e))?i:r)===m?i.call(o,{name:"title",hash:{},data:t,loc:{start:{line:1,column:31},end:{line:1,column:40}}}):i)+" by "+u(typeof(i=null!=(i=c(a,"authorName")||(null!=e?c(e,"authorName"):e))?i:r)===m?i.call(o,{name:"authorName",hash:{},data:t,loc:{start:{line:1,column:44},end:{line:1,column:58}}}):i)+", "+u((c(a,"intlMessage")||e&&c(e,"intlMessage")||r).call(o,{name:"intlMessage",hash:{intlName:"share-modal.ON_FLICKR"},data:t,loc:{start:{line:1,column:60},end:{line:1,column:108}}}))+'"><img src="'+u(typeof(i=null!=(i=c(a,"farmURL")||(null!=e?c(e,"farmURL"):e))?i:r)===m?i.call(o,{name:"farmURL",hash:{},data:t,loc:{start:{line:1,column:120},end:{line:1,column:131}}}):i)+'" width="'+u(typeof(i=null!=(i=c(a,"width")||(null!=e?c(e,"width"):e))?i:r)===m?i.call(o,{name:"width",hash:{},data:t,loc:{start:{line:1,column:140},end:{line:1,column:149}}}):i)+'" height="'+u(typeof(i=null!=(i=c(a,"height")||(null!=e?c(e,"height"):e))?i:r)===m?i.call(o,{name:"height",hash:{},data:t,loc:{start:{line:1,column:159},end:{line:1,column:169}}}):i)+'" alt="'+u(typeof(i=null!=(i=c(a,"alt")||(null!=e?c(e,"alt"):e))?i:r)===m?i.call(o,{name:"alt",hash:{},data:t,loc:{start:{line:1,column:176},end:{line:1,column:183}}}):i)+'"></a>'},useData:!0}),n={};l.Array.each([],(function(e){var a=l.Template.get("hermes/"+e);a&&(n[e]=a)})),l.Template.register("hermes/fluid-share-old-html-embed-code",(function(e,t){return(t=t||{}).partials=t.partials?l.merge(n,t.partials):n,a(e,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-fluid-share-old-iframe-embed-code",(function(e,l){var a=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,l,a,n,r){var t,i=null!=l?l:e.nullContext||{},o=e.hooks.helperMissing,s="function",u=e.escapeExpression,m=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'<iframe src="'+u(typeof(t=null!=(t=m(a,"embedLink")||(null!=l?m(l,"embedLink"):l))?t:o)===s?t.call(i,{name:"embedLink",hash:{},data:r,loc:{start:{line:1,column:13},end:{line:1,column:26}}}):t)+'" width="'+u(typeof(t=null!=(t=m(a,"width")||(null!=l?m(l,"width"):l))?t:o)===s?t.call(i,{name:"width",hash:{},data:r,loc:{start:{line:1,column:35},end:{line:1,column:44}}}):t)+'" height="'+u(typeof(t=null!=(t=m(a,"height")||(null!=l?m(l,"height"):l))?t:o)===s?t.call(i,{name:"height",hash:{},data:r,loc:{start:{line:1,column:54},end:{line:1,column:64}}}):t)+'" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>'},useData:!0}),n={};e.Array.each([],(function(l){var a=e.Template.get("hermes/"+l);a&&(n[l]=a)})),e.Template.register("hermes/fluid-share-old-iframe-embed-code",(function(l,r){return(r=r||{}).partials=r.partials?e.merge(n,r.partials):n,a(l,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("flutil",(function(e){"use strict";var t,n=e.config.win,r=e.config.doc,o=2e3,i={getPrefixedStyleProperty:{}},a={};t=e.flutil={xbrowser:{transition:{property:"transitionProperty",duration:"transitionDuration",transitionEndEvent:"transitionend"}},setStylePrefixed:function(t,n,r){var o=this.getPrefixedStyleProperty(t);return e.Array.each(o,(function(e){r.setStyle(e,n)})),r},getPrefixedStyleProperty:function(t){if(i.getPrefixedStyleProperty[t])return i.getPrefixedStyleProperty[t];var n=[];return e.Array.each(["-webkit-","-moz-","-ms-",""],(function(e){n.push(e+t)})),i.getPrefixedStyleProperty[t]=n,n},dump:function(){for(var e,t=new Array(arguments.length),n=0;n<t.length;++n)t[n]=arguments[n];e="string"==typeof t[0]?t.shift():"LOG",t.unshift("color: #FC0"),t.unshift("%c["+e+"]"),console.log.apply(console,t)},extend:function(e){e||(e={});for(var t=new Array(arguments.length),n=0;n<t.length;++n)t[n]=arguments[n];return Array.prototype.slice.call(t,1).forEach((function(t){if(t)for(var n in t)e[n]=t[n]})),e},objectCreate:function(e,n){var r,o;return(r=function(){}).prototype=e,o=new r,n?t.extend(o,n):o},result:function(t){return e.Lang.isFunction(t)?t():t},onTransitionEnd:function(e,r){if(r&&"function"==typeof r){var i,a,u,s;if(e=e.getDOMNode(),u=n.getComputedStyle(e)[t.xbrowser.transition.property],s=n.getComputedStyle(e)[t.xbrowser.transition.duration],!u||!s)return r();a=function(){clearTimeout(i),e.removeEventListener(t.xbrowser.transition.transitionEndEvent,a),r()},i=setTimeout(a,o),e.addEventListener(t.xbrowser.transition.transitionEndEvent,a)}},toCamelCase:function(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()},setCookie:function(t){if(!t.cookieName||void 0===t.cookieValue||!t.path)throw new Error("[flutil.setCookie] Missing important parameters to set a cookie");var n=t.cookieName,r=t.cookieValue,o=t.domain||".flickr.com",i=t.path,a=t.expiresMonthsFromNow||3,u=e.Lang.isNumber(t.expires)?t.expires:e.moment().add(a,"months").toDate();t.remove&&e.Cookie.remove(n,{path:i}),e.Cookie.set(n,r,{domain:o,path:i,expires:u})},createFragment:function(e){var t,n=r.createElement("div"),o=r.createDocumentFragment();for(n.innerHTML=e;t=n.firstChild;)o.appendChild(t);return o},constrainToValues:function(e,t){if(!t)throw new Error("Must supply list to constrain to values.");return e&&"string"==typeof e?t.indexOf(e)<0?t[0]:e:t[0]},escapeInput:function(e,t){var n;return r?e||"number"==typeof e?(t||(t="text"),"html"===t?((n=r.createElement("div")).appendChild(r.createTextNode(e)),n.innerHTML):"text"===t?(n=r.createElement("div"),e=e.replace(/(<([^>]+)>\s*)+/gi," ").trim(),n.appendChild(r.createTextNode(e)),n.innerHTML):"numericstring"===t?(e+"").replace(/[^\d]/,""):void 0):"":e},disableEvent:function(n,r){r=e.merge({excepted:":not(*)",onDisabledEvent:null},r),document.body.addEventListener&&(a[n]=a[n]||{},a[n][r.excepted]&&t.enableEvent(n,r.excepted),a[n][r.excepted]=function(t){r.excepted&&e.one(t.target).ancestors(r.excepted,!0).isEmpty()&&(t.preventDefault(),t.stopPropagation(),r.onDisabledEvent&&r.onDisabledEvent(t))},document.body.addEventListener(n,a[n][r.excepted],!0))},enableEvent:function(t,n){n=e.merge({excepted:":not(*)"},n),a[t]&&a[t][n.excepted]&&(document.body.removeEventListener(t,a[t][n.excepted],!0),a[t][n.excepted]=null)},unescape:function(t){if(!t||!e.Lang.isString(t))return t;var n={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#39;":"'","&#92;":"\\"};return t.replace(/(&amp;|&lt;|&gt;|&quot;|&#x27;|&#39;|&#92;)/gi,(function(e){return n[e.toLowerCase()]}))},normalizeURIComponents:function(e){var t,n,r,o;if(t={"&":["&amp;","&#x00026;","&#38;"],"<":["&lt;","&#x0003C;","&#60;"],">":["&gt;","&#x0003E;","&#62;"],'"':["&quot;","&#x00022;","&#34;"],"'":["&apos;","&#x00027;","&#39;"],"`":["&grave;","&DiacriticalGrave;","&#x00060;","&#96;"]},e){for(n in e=(e=e.replace(/\+/g," ")).replace(/%25/g,"%2525"),t)r=n,o=t[n],e=e.replace(new RegExp(o.join("|"),"gi"),r);return e=decodeURIComponent(e)}},template:function(e,t){return e.replace(/\{\{([\w\.=]+)\}\}/g,(function(e,n){var r,o=n.split(/=/);return r=o[0].split(/\./).reduce((function(e,t){return e?e[t]:null}),t),null!=r?r+"":o[1]||""})).trim()},createHashCode:function(e){var t;return t="object"!=typeof e?e+"":Object.keys(e||{}).map((function(t){var n=t;try{n+=JSON.stringify(e[t])}catch(e){n+="?"}return n})).join(""),t=t.split("").reduce((function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e}),0).toString().replace(/^-/,""),"0000000000".slice(0,-1*t.length)+t},camelCaseifyKeys:function(e){return Object.keys(e).reduce((function(n,r){return n[t.camelCaseify(r)]=e[r],n}),{})},camelCaseify:function(e){return e.replace(/-(\w)/gi,(function(e,t){return t.toUpperCase()}))},unCamelCaseify:function(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^-/,"")},unicodeVariants:["(?:ae|æ)","(?:oe|œ)","(?:ss|ß)","(?:th|Þ)","[aáàâäãaåấ]","[eéèêëě3]","[iíìîïǐ]","[oóòôöõǒỏơớờởỡợø]","[uúùûüǔǚưứừửữự]","[yýÿ]","[cçč]","[dÐ]","[fƒ]","[gǧ]","[hȟ]","[jǰ]","[kǩ]","[lľ]","[nñň]","[rř®]","[sšṧ]","[tť]","[zž]"],agnosticizeUnicode:function(e){var t,n=this.unicodeVariants,r=n.length;for(t=0;t<r;t++)e=e.replace(new RegExp(n[t],"gi"),n[t]);return e},buildHttpQuery:function(e,t){return e+"?"+Object.keys(t||{}).map((function(e){return e+"="+encodeURIComponent(t[e])})).join("&")},formatNumbers:function(e){return Math.floor(e/1e6)>0?Math.floor(e/1e5)/10+"M":Math.floor(e/1e3)>0?Math.floor(e/100)/10+"K":e},formatIntlPluralNumber:function(t,n,r){var o=e.flutil.formatNumbers(n);return r?t.replace(/(?:\d*[,\.]\d+)+/,o):t.replace(/(?:\d*[,\.\s]\d+)+/,o)},openPopupWindow:function(t,n){var r,o,i,a,u,s;if("undefined"!=typeof window)return o=window,n=e.mix({name:"WIN"+(new Date).getTime(),ui:{}},n||{},!0),(i=e.mix({dependent:!0,status:!0,scrollbars:!0,width:600,height:600},n.ui,!0)).top||(i.top=Math.floor((o.screen.height-i.height)/2)),i.left||(i.left=Math.floor((o.screen.width-i.width)/2)),r=Object.keys(i).map((function(e){var t=i[e];return"boolean"==typeof t&&(t=t?"yes":"no"),e+"="+t})).join(","),(o=o.open(t,n.name,r)).focus(),(n.onUrlChange||n.onClose)&&(a="_start_",s=setInterval((function(){if(!o.location)return clearInterval(s),void(n.onClose&&n.onClose());try{u=o.location.href||"x-origin"}catch(t){o.postMessage("",e.url())}u!==a&&(a=u,n.onUrlChange&&n.onUrlChange(u))}),1e3)),o},parseYYYYMMDDDatestamp:function(t){return e.Lang.isString(t)&&8===t.length?Date.parse(t.substr(0,4)+"-"+t.substr(4,2)+"-"+t.substr(6,2)):null},photoCoords:{normalize:function(e,t,n,r){return{x:e/500,y:t/375,w:n/500,h:r/375}},denormalize:function(e){return{x:500*e.x,y:375*e.y,w:500*e.w,h:375*e.h}},denormX:function(e){return 500*e.x},denormY:function(e){return 375*e.y},denormW:function(e){return 500*e.w},denormH:function(e){return 375*e.h}},getGroupsOptoutValues:function(t){var n=[];return!0===t["rebootify-group-members"]&&n.push({name:"groups_members_opt",value:0}),!0===t["enable-groups-discussion-optout"]&&n.push({name:"groups_discuss_opt",value:0}),!0===t["enable-groups-optout"]&&n.push({name:"groups_opt",value:0}),{url:e.url("/help/forum/en-us/72157645851675914/lastpage#reply"),flippers:n}},nonLockingSynchronousLoop:function(e,t,n,r){var o,i=0,a=!0,u=Object.keys(e),s=function(e){t(e),++i>=c?n():i===o||a?(i===o&&(o+=r.threshold),a=!1,setTimeout((function(){s(u[i])}),1)):s(u[i])},c=u.length;(r=r||{}).threshold=r.threshold||1e3,o=r.threshold,a=!1!==r.earlyUnlock,s(u[i])},shuffleFisherYates:function(e){for(var t,n,r=e.slice(0),o=r.length;0!==o;)n=Math.floor(Math.random()*o),t=r[o-=1],r[o]=r[n],r[n]=t;return r}}}),"@VERSION@",{requires:["url"]});YUI.add("flickr-contacts-getListfetcher",(function(e,t){"use strict";e.namespace("ListFetchers")["flickr-contacts-getList"]={run:function(r,s){var c=this;return r.extras=(r.extras||"")+", icon_urls, paid_products",e.Promise.all([s.callAPI("flickr.contacts.getList",r),s.getModelRegistry("person-models")]).then((function(e){return c._processResponse(e,r)}),e.FetcherErrorLogger(t))},_processResponse:function(t,r){var s=t[0],c=t[1];return s.contacts&&s.contacts.contact&&s.contacts.contact.forEach((function(t){c.addOrUpdate(e.APIHelper.response.parsePerson(t))})),s}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["person-models"]});YUI.add("contact-search-box",(function(t){var e,i=function(i){this.options=i,this.options.elValue=this.options.elValue||"value",this.options.hideInitially,this._contacts=null,this.queryEl=this.options.el,this.queryElEvent,this.listEl=null,e=this.options.DOMContainer||t.config.win,this.init()};i.prototype={langBundles:this.details.langBundles,init:function(){var e=this;if(!1!==this.options.showFollowingState&&(this.options.showFollowingState=!0),!this.queryEl)throw new Error("Need this.queryEl.");this.queryEl.on("keydown",this.keynav.bind(this)),this.queryElEvent=this.queryEl.on("keyup",this.search.bind(this)),this.wrapperEl=t.Node.create("<div/>"),this.wrapperEl.addClass("c-contact-search-autocomplete"),this.listEl=t.Node.create("<ul/>"),this.listEl.addClass("contact-list"),this.wrapperEl.appendChild(this.listEl),this.listEl.on("mouseover",(function(t){var i=t.target.ancestor("li",!0);i&&i!==e.highlighted&&e._highlight(i)})),this.queryEl.ancestor().insertBefore(this.wrapperEl,this.queryEl),this.wrapperEl.appendChild(this.queryEl),this.options.clickContact=this.options.clickContact||function(t){var i=t.target.ancestor("[data-nsid]",!0),s=i?i.getData("nsid"):"";e.select(s)},this.listEl.delegate("click",this.options.clickContact,"li"),this.selectedIndex=0},keynav:function(t){38===t.keyCode?(t.preventDefault(),this.selectedIndex--,this.selectedIndex<0&&(this.selectedIndex=this.numShowing+this.selectedIndex),this._highlight(this.selectedIndex),this._scrollToNode(this.highlighted)):40===t.keyCode?(t.preventDefault(),this.selectedIndex++,this.selectedIndex>this.numShowing-1&&(this.selectedIndex=this.numShowing-this.selectedIndex),this._highlight(this.selectedIndex),this._scrollToNode(this.highlighted)):9===t.keyCode?this._visible&&this.highlighted&&(t.preventDefault(),this.select(this.highlighted.getData("nsid"))):13===t.keyCode&&this._visible&&this.highlighted&&(t.preventDefault(),t.target.ancestor(".share-view",!0)||t.target.ancestor(".fluid-share-panel-view",!0)?this.select(this.highlighted.getData("nsid")):this.options.clickContact(t,this.highlighted))},_highlight:function(e){var i=this.listEl.all("li"),s=e instanceof t.Node,n=s?e:i.item(e),o=s?i.indexOf(e):e;!n||n.hasClass("loading")||n.hasClass("no-members")||(i.removeClass("highlight"),n.addClass("highlight"),this.selectedIndex=o,this.highlighted=n)},_scrollToNode:function(t){var e=this.listEl.get("scrollTop"),i=e+this.listEl.get("clientHeight"),s=t.get("offsetTop"),n=s+t.get("clientHeight");e>s?this.listEl.set("scrollTop",s-5):i<n&&this.listEl.set("scrollTop",n-this.listEl.get("clientHeight")+5)},getContact:function(t){for(var e=0,i=this._contacts,s=i.length;e<s;e++)if(i[e].nsid===t&&!i[e].hide)return i[e]},hideFromSearch:function(t){t=t.trim(),this._contacts&&this._contacts.some((function(e){if(e.nsid.trim()===t)return e.hide=!0,!0}))},resetSearch:function(){this._contacts&&this._contacts.forEach((function(t){t.hide=!1}))},showInSearch:function(t){t=t.trim(),this._contacts&&this._contacts.some((function(e){if(e.nsid.trim()===t)return e.hide=!1,!0}))},load:function(t){var e,i={},s=this;if(!this._busy)return this._end=!1,this._busy=!0,i.can_tag=this.options.canTag||0,e=this.options.appContext.getViewer().nsid,this.options.appContext.getModel("contacts-models",e).then((function(e){return i.page=1,i.perPage=3e3,i.per_page=3e3,s._loadMoreContacts(e,i,t)}),(function(){s._busy=!1,s.options.onError()}))},_loadMoreContacts:function(t,e,i){var s=this;return this._busy=!0,s.options.loadingState&&!s.listEl.one("li.loading")&&s.appendLoader(),t.getValue("contacts").getPage(e).then((function(n){s._contacts=(s.processContactModels(n,!0,!0)||[]).concat(s._contacts||[]),i(),s._contacts&&0!==s._contacts.length||s.hide(),e.page<t.getValue("pages")&&(e.page++,s._loadMoreContacts(t,e,i))}),(function(){s._busy=!1,s.options.onError()}))},processContactModels:function(e,i,s){var n,o,l,h=this;try{l=e.map((function(t){return t.toJSON()}))||[]}catch(t){l=[]}if(!h.contactIds&&(h.contactIds={},h._contacts))for(o in h._contacts)h.contactIds[o.id]=!0;return(l=l.filter((function(t){return!h.contactIds[t.id]}))).forEach((function(e,i){h.contactIds[e.id]=!0,e.realname=e.realname||e.username,e.isContact=s,e.buddyicon=t.URLHelper.getBuddyIconURL(e.nsid,e.iconfarm,e.iconserver)})),i&&h.options.me&&(n=h.options.me.toJSON(),t.APIHelper.response.removeProtocolFromURL(n.buddyicon),n.buddyicon=n.buddyicon.default,h.contactIds[n.id]=!0,n.me=!0,l.push(n)),h.options.hideInitially&&l.forEach((function(t){h.options.hideInitially.indexOf(t.nsid)>-1&&(t.hide=!0)})),l},destructor:function(){this.queryElEvent&&this.queryElEvent.detach&&this.queryElEvent.detach()},hide:function(t){t&&t.halt(),this._visible&&(this._visible=!1,this.highlighted=null,this.selectedIndex=0,this.selected=null,this.options.noShim||this._shimUp(!1),this.listEl.setStyle("display","none"),this.options.onHide&&this.options.onHide())},show:function(){this._visible||(this._visible=!0,this.options.noShim||this._shimUp(),this.listEl.setStyle("display","block"),this._reposition(),this.options.onShow())},_reposition:function(){e.innerWidth||e.clientWidth;var i,s=e.innerHeight||e.clientHeight,n=this.options.el,o=n.getDOMNode(),l=o.getBoundingClientRect(),h=this.listEl.getDOMNode().getBoundingClientRect(),a=!this._contacts&&this.options.upInitially,c=e===t.config.win?l.top:o.clientTop;this.options.dialogOffset&&(i=this.options.dialogOffset()),a||c>0&&c+h.height+25>s&&!this.options.alwaysDownward?(this.listEl.setStyle("top","auto"),this.listEl.setStyle("bottom","25px"),this.options.onOrientationChange&&this.options.onOrientationChange(!0)):(this.listEl.setStyle("top",i||null),this.listEl.setStyle("bottom",null),this.options.onOrientationChange&&this.options.onOrientationChange(!1),n.ancestor(".modal",!0)&&this.listEl.setStyle("maxHeight",s-c-25))},_shimUp:function(e){if(!1===e){if(!this._shim)return;return this._shim.detach("click").remove(),void(this._shim=null)}this._shim=t.Node.create("<div/>"),this._shim.addClass(this.options.shim),this._shim.on("click",this.hide.bind(this)),this.wrapperEl.appendChild(this._shim)},select:function(t){"string"==typeof t&&(t=this.getContact(t))&&this.queryEl.set("value",t.realname),t&&(this.selected=t,this.options.onSelect(t)),this.hide()},search:function(t){var e,i,s=this.queryEl.get(this.options.elValue),n=this,o=this.options.appContext.getViewer().nsid;if(t&&27===t.keyCode)return t.preventDefault(),void this.queryEl.blur();if(t&&-1!==[38,40,9].indexOf(t.keyCode))t.preventDefault();else{if(this._nameTest(s),this.selected=null,this.selectedIndex=0,this.abort=!1,""===s.trim())return this.abort=!0,this.hide();if(this.options.searchNonContacts||(this._end=!0,this._busy=!1),this._contacts&&this.options.me&&"me"===s)return this.showResults(this._contacts.filter((function(t){return!t.hide&&t.me})).concat(this._contacts.filter((function(t){return!t.hide&&n._matchesQuery(t)}))));if(this._isEmail(s))return this.select({email:s,nsid:null});if(/,/.test(s))return this.select(null);if(!this._contacts){if(this.options.signedOut)return;this.showResults(),this.load(this.search.bind(this))}this._contacts&&(e=this._contacts.filter((function(t){return!t.hide&&n._matchesQuery(t)}))),this.showResults(e),n.listEl.getDOMNode(),this.options.searchNonContacts&&(this.options.loadMoreOnScroll&&s.length>0?(i=1,clearTimeout(this.searchAllPeople),this.searchInstanceId=999999*Math.random(),this.searchAllPeople=setTimeout((function(){n._searchPeople(s,o,i,n.searchInstanceId,(function(){n._busy=!1,n.showResults(n._contacts.filter((function(t){return!t.hide&&n._matchesQuery(t)}))),n.listElScrollEvent=n.listEl.on("scroll",(function(){n.listEl._node.clientHeight+n.listEl._node.scrollTop===n.listEl._node.scrollHeight&&(i++,n._loadMore(i,o,s))}))}))}),500)):(clearTimeout(this.searchAllPeople),this.searchInstanceId=999999*Math.random()))}},_loadMore:function(t,e,i){var s=this;this._busy=!0,clearTimeout(this.searchAllPeople),this.searchInstanceId=999999*Math.random(),this.searchAllPeople=setTimeout((function(){s.options.loadingState&&!s.listEl.one("li.loading")&&s.appendLoader(),s._searchPeople(i,e,t,s.searchInstanceId,(function(){s.showResults(s._contacts.filter((function(t){return!t.hide&&s._matchesQuery(t)}))),s.listElScrollEvent&&s.listElScrollEvent.detach(),s.listElScrollEvent=s.listEl.on("scroll",(function(){s.listEl._node.clientHeight+s.listEl._node.scrollTop===s.listEl._node.scrollHeight&&(t++,s._loadMore(t,e,i))}))}))}),100)},_nameTest:function(e){var i=new RegExp(".*"+t.flutil.agnosticizeUnicode(e).replace(/\s/,"\\s")+".*","ig");this._matchesQuery=function(t){return i.test(t.username)||i.test(t.realname)||i.test(t.email)}},appendLoader:function(t){t=t||this.listEl;var e=document.createElement("li"),i=t.scrollTop;e.className="loading",e.innerHTML=this.options.loadingState,t.appendChild(e),t.scrollTop=i+e.clientHeight},_searchPeople:function(t,e,i,s,n){var o=this;o._end=!1,o.options.loadingState&&!o.listEl.one("li.loading")&&o.appendLoader(),o.options.appContext.getModel("contacts-models",e).then((function(e){return e.search({username:t,page:i}).then((function(t){var e=t.people,i=o.processContactModels(e,!1,!1);o._contacts=o._contacts||[],o._contacts=o._contacts.concat(i),o._contacts.some((function(t){return o._matchesQuery(t)}))||(o._end=!0),n()}),(function(){o._end=!0,o._busy=!1,n()}))}),(function(){o._end=!0,o._busy=!1,n()}))},_isEmail:function(t,e){t=/,/.test(t)?t.split(/,/):[t];var i=/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/;if(e){for(;t.length;)if(i.test(t.shift().trim()))return!0;return!1}for(;t.length;)if(!i.test(t.shift().trim()))return!1;return!0},showResults:function(e){if(!this.abort){var i,s,n=this.options.max||10,o=this;i=document.createDocumentFragment(),e&&this.selectedIndex>=e.length&&(this.selectedIndex=e.length-1),this.numShowing=Math.min(n,e&&e.length||0),!o._busy&&e&&0===e.length?((s=document.createElement("li")).innerHTML='<span class="no-contacts">'+this.intlMessage({intlName:"photo-page-scrappy.NO_MEMBERS_FOUND"})+"</span>",s.className="no-members",i.appendChild(s),o.highlighted=null):e&&e.slice(0,n).forEach((function(e,s,n){var l=o.createItem(e);s===o.selectedIndex&&(l.setAttribute("class","highlight"),o.highlighted=t.Node(l)),i.appendChild(l)})),!o._busy&&e||!o.options.loadingState||o.appendLoader(i),this.options.loadMoreOnScroll&&this.listElScrollEvent&&this.listElScrollEvent.detach(),this.listEl.setHTML(""),this.listEl.getDOMNode().appendChild(i),this.show()}},_template:function(){return['<img src="{{buddyicon}}">','<div class="following-status {{isContact}}">','<span class="following-icon">&nbsp;</span>',"<span>"+this.intlMessage({intlName:"common.FOLLOWING"})+"</span>","</div>",'<h2 class="all">{{realname}}</h2>','<h3 class="all">{{username}}</h3>'].join("")},_onlyContactTemplate:['<img src="{{buddyicon}}">',"<h2>{{realname}}</h2>","<h3>{{username}}</h3>"].join(""),createItem:function(e){var i,s=document.createElement("li"),n=this.options.searchNonContacts&&this.options.showFollowingState?this._template():this._onlyContactTemplate,o=this.options.truncateLength||70;return i=n.replace(/\{\{(\w+)\}\}/g,(function(i,s){if("buddyicon"===s)return e[s];if("isContact"===s)return e[s]?"am-following":"";var n=t.flutil.escapeInput(e[s]);return t.Handlebars.helpers.truncate(n,o)})),s.innerHTML=i,s.dataset?(s.dataset=s.dataset,s.dataset.nsid=e.nsid,s.dataset.displayname=e.realname||e.username,s.dataset.pathAlias=e.pathAlias,s.dataset.ispro=e.isPro,s.dataset.probadge=e.proBadge):(s.setAttribute("data-nsid",e.nsid),s.setAttribute("data-displayname",e.realname||e.username),s.setAttribute("data-path-alias",e.pathAlias),s.setAttribute("data-ispro",e.isPro),s.setAttribute("data-probadge",e.proBadge)),s}},t.mix(i.prototype,t.Localizable),t.ContactSearchBox=i}),"@VERSION@",{requires:["api-helper","flutil","handlebars-helpers","flickr-contacts-getListfetcher"],langBundles:["common","photo-page-scrappy"]});YUI.add("hermes-template-html5-balls",(function(e,a){var l=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,l,t,r){return'\n<div class="html5-balls">\n\t<div class="blueball"></div>\n\t<div class="pinkball"></div>\n</div>\n'},useData:!0}),t={};e.Array.each([],(function(a){var l=e.Template.get("hermes/"+a);l&&(t[a]=l)})),e.Template.register("hermes/html5-balls",(function(a,r){return(r=r||{}).partials=r.partials?e.merge(t,r.partials):t,l(a,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});