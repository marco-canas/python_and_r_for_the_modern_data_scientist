YUI.add("hermes-template-photo-well-media-scrappy",(function(n,t){var l=n.Template.Handlebars.revive({1:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t<div class="restricted-interstitial">\n\t\t<div class="restricted-interstitial-message">\n\t\t\t<h2>'+n.escapeExpression((s(l,"intlMessage")||t&&s(t,"intlMessage")||n.hooks.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:a,loc:{start:{line:4,column:7},end:{line:4,column:66}}}))+"</h2>\n"+(null!=(o=s(l,"if").call(i,null!=t?s(t,"isSignedIn"):t,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.program(5,a,0),data:a,loc:{start:{line:5,column:3},end:{line:14,column:10}}}))?o:"")+"\t\t</div>\n\t</div>\n"},2:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r=n.escapeExpression,c=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return"\t\t\t\t<p>"+r((c(l,"intlMessage")||t&&c(t,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:a,loc:{start:{line:6,column:7},end:{line:6,column:69}}}))+"<br />"+r((c(l,"intlMessage")||t&&c(t,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:a,loc:{start:{line:6,column:75},end:{line:6,column:136}}}))+"</p>\n\n"+(null!=(o=c(l,"unless").call(i,null!=t?c(t,"isMinor"):t,{name:"unless",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:8,column:4},end:{line:11,column:15}}}))?o:"")},3:function(n,t,l,e,a){var o=null!=t?t:n.nullContext||{},i=n.hooks.helperMissing,s=n.escapeExpression,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return"\t\t\t\t\t<p><button class='ui-button'><span>"+s((r(l,"intlMessage")||t&&r(t,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:a,loc:{start:{line:9,column:40},end:{line:9,column:111}}}))+"</span></button></p>\n\t\t\t\t\t<p>"+s((r(l,"intlHTMLMessage")||t&&r(t,"intlHTMLMessage")||i).call(o,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:a,loc:{start:{line:10,column:8},end:{line:10,column:88}}}))+"</p>\n"},5:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r=n.escapeExpression,c=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return"\t\t\t\t<p>"+r((c(l,"intlMessage")||t&&c(t,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:a,loc:{start:{line:13,column:7},end:{line:13,column:74}}}))+' <a href="//'+r("function"==typeof(o=null!=(o=c(l,"host")||(null!=t?c(t,"host"):t))?o:s)?o.call(i,{name:"host",hash:{},data:a,loc:{start:{line:13,column:86},end:{line:13,column:94}}}):o)+'/signin/" data-track="photoWellSignInClick">'+r((c(l,"intlMessage")||t&&c(t,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:a,loc:{start:{line:13,column:138},end:{line:13,column:179}}}))+"</a></p>\n"},7:function(n,t,l,e,a){var o,i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(o=i(l,"if").call(null!=t?t:n.nullContext||{},null!=t?i(t,"isVideo"):t,{name:"if",hash:{},fn:n.program(8,a,0),inverse:n.program(10,a,0),data:a,loc:{start:{line:18,column:1},end:{line:45,column:8}}}))?o:""},8:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r="function",c=n.escapeExpression,u=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t<div class="videoplayer main-photo" style="width: '+c(typeof(o=null!=(o=u(l,"width")||(null!=t?u(t,"width"):t))?o:s)===r?o.call(i,{name:"width",hash:{},data:a,loc:{start:{line:19,column:52},end:{line:19,column:61}}}):o)+"px; height: "+c(typeof(o=null!=(o=u(l,"height")||(null!=t?u(t,"height"):t))?o:s)===r?o.call(i,{name:"height",hash:{},data:a,loc:{start:{line:19,column:73},end:{line:19,column:83}}}):o)+'px;"><video id="video_1" poster="'+c(typeof(o=null!=(o=u(l,"src")||(null!=t?u(t,"src"):t))?o:s)===r?o.call(i,{name:"src",hash:{},data:a,loc:{start:{line:19,column:116},end:{line:19,column:123}}}):o)+'" class="video-js vjs-big-play-centered inherit-size"></video></div>\n'},10:function(n,t,l,e,a){var o,i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(o=i(l,"if").call(null!=t?t:n.nullContext||{},null!=t?i(t,"showFuzzy"):t,{name:"if",hash:{},fn:n.program(11,a,0),inverse:n.program(13,a,0),data:a,loc:{start:{line:21,column:2},end:{line:44,column:9}}}))?o:""},11:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r="function",c=n.escapeExpression,u=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t<span class="restricted-image main-photo" style="width: '+c(typeof(o=null!=(o=u(l,"width")||(null!=t?u(t,"width"):t))?o:s)===r?o.call(i,{name:"width",hash:{},data:a,loc:{start:{line:22,column:59},end:{line:22,column:68}}}):o)+"px; height: "+c(typeof(o=null!=(o=u(l,"height")||(null!=t?u(t,"height"):t))?o:s)===r?o.call(i,{name:"height",hash:{},data:a,loc:{start:{line:22,column:80},end:{line:22,column:90}}}):o)+'px;"></span>\n'},13:function(n,t,l,e,a){var o,i,s=null!=t?t:n.nullContext||{},r=n.hooks.helperMissing,c="function",u=n.escapeExpression,p=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t<style id="photoWellDynamicSizer"></style>\n\t\t\t<picture>\n'+(null!=(o=p(l,"each").call(s,null!=t?p(t,"sources"):t,{name:"each",hash:{},fn:n.program(14,a,0),inverse:n.noop,data:a,loc:{start:{line:26,column:4},end:{line:28,column:13}}}))?o:"")+'\t\t\t\t<img src="'+u(typeof(i=null!=(i=p(l,"src")||(null!=t?p(t,"src"):t))?i:r)===c?i.call(s,{name:"src",hash:{},data:a,loc:{start:{line:29,column:14},end:{line:29,column:21}}}):i)+'" alt="'+u(typeof(i=null!=(i=p(l,"imgAltText")||(null!=t?p(t,"imgAltText"):t))?i:r)===c?i.call(s,{name:"imgAltText",hash:{},data:a,loc:{start:{line:29,column:28},end:{line:29,column:42}}}):i)+'">\n\t\t\t</picture>\n\n\t\t\t<span class="facade-of-protection-neue">\n\t\t\t\t'+u((p(l,"outlet")||t&&p(t,"outlet")||r).call(s,null!=t?p(t,"zoom-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:33,column:4},end:{line:33,column:24}}}))+"\n\t\t\t\t"+u((p(l,"outlet")||t&&p(t,"outlet")||r).call(s,null!=t?p(t,"vr-overlay-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:34,column:4},end:{line:34,column:30}}}))+"\n\t\t\t</span>\n\n"},14:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r="function",c=n.escapeExpression,u=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t<source srcset="'+c(typeof(o=null!=(o=u(l,"srcset")||(null!=t?u(t,"srcset"):t))?o:s)===r?o.call(i,{name:"srcset",hash:{},data:a,loc:{start:{line:27,column:21},end:{line:27,column:31}}}):o)+'" media="'+c(typeof(o=null!=(o=u(l,"media")||(null!=t?u(t,"media"):t))?o:s)===r?o.call(i,{name:"media",hash:{},data:a,loc:{start:{line:27,column:40},end:{line:27,column:49}}}):o)+'" data-size="'+c(typeof(o=null!=(o=u(l,"dataSize")||(null!=t?u(t,"dataSize"):t))?o:s)===r?o.call(i,{name:"dataSize",hash:{},data:a,loc:{start:{line:27,column:62},end:{line:27,column:74}}}):o)+'" data-width="'+c(typeof(o=null!=(o=u(l,"dataWidth")||(null!=t?u(t,"dataWidth"):t))?o:s)===r?o.call(i,{name:"dataWidth",hash:{},data:a,loc:{start:{line:27,column:88},end:{line:27,column:101}}}):o)+'" data-height="'+c(typeof(o=null!=(o=u(l,"dataHeight")||(null!=t?u(t,"dataHeight"):t))?o:s)===r?o.call(i,{name:"dataHeight",hash:{},data:a,loc:{start:{line:27,column:116},end:{line:27,column:130}}}):o)+'">\n'},compiler:[8,">= 4.3.0"],main:function(n,t,l,e,a){var o,i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(o=i(l,"if").call(null!=t?t:n.nullContext||{},null!=t?i(t,"needsInterstitial"):t,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.program(7,a,0),data:a,loc:{start:{line:1,column:0},end:{line:46,column:7}}}))?o:""},useData:!0}),e={};n.Array.each([],(function(t){var l=n.Template.get("hermes/"+t);l&&(e[t]=l)})),n.Template.register("hermes/photo-well-media-scrappy",(function(t,a){return(a=a||{}).partials=a.partials?n.merge(e,a.partials):e,l(t,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-sub-photo-moola-view",(function(t,n){var e=t.Template.Handlebars.revive({1:function(t,n,e,a,r){return'\t\t\t\t\t\t<a target="_blank" href="/account/upgrade/pro" title="Flickr Pro">Flickr Pro</a>\n'},3:function(t,n,e,a,r){return'\t\t\t\t\t\t<a href="#" class="sponsored-title" title="Sponsored Advertiser">Sponsored Advertiser</a>\n'},5:function(t,n,e,a,r){return'\t\t\t\t\t\t\t<a target="_blank" href="/account/upgrade/pro">Sign up today!</a>\n'},7:function(t,n,e,a,r){return'\t\t\t\t\t\t\t<a target="_blank" href="https://flickrhelp.com/hc/en-us/articles/4404057954068-Ad-free-Browsing-and-Ad-free-Sharing-of-Photos">Learn more about ads</a>\n'},compiler:[8,">= 4.3.0"],main:function(t,n,e,a,r){var o,i,l=null!=n?n:t.nullContext||{},s=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<div class="sub-photo-container centered-content">\n\t<div class="sub-photo-content-container">\n\t\t<div class="view sub-photo-left-view">\n\t\t\t<div class="attribution-view photo-attribution">\n\t\t\t\t<a class="attribution-icon no-menu circle-icon" href="#" data-track="ad_link_rail_icon" target="_blank">\n\t\t\t\t\t<img src="'+t.escapeExpression("function"==typeof(i=null!=(i=s(e,"assetRoot")||(null!=n?s(n,"assetRoot"):n))?i:t.hooks.helperMissing)?i.call(l,{name:"assetRoot",hash:{},data:r,loc:{start:{line:6,column:15},end:{line:6,column:28}}}):i)+'/images/general/moola.png"/>\n\t\t\t\t</a>\n\n\t\t\t\t<div class="attribution-info">\n'+(null!=(o=s(e,"if").call(l,null!=n?s(n,"isProUpsell"):n,{name:"if",hash:{},fn:t.program(1,r,0),inverse:t.program(3,r,0),data:r,loc:{start:{line:10,column:5},end:{line:14,column:12}}}))?o:"")+'\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="view sub-photo-title-desc-view" id="yui_3_16_0_rc_1_1_1401741750198_2372">\n\t\t\t\t<div class="title-desc-block">\n\t\t\t\t\t<span class=" meta-field photo-title ">\n'+(null!=(o=s(e,"if").call(l,null!=n?s(n,"isProUpsell"):n,{name:"if",hash:{},fn:t.program(5,r,0),inverse:t.program(7,r,0),data:r,loc:{start:{line:21,column:6},end:{line:25,column:13}}}))?o:"")+'\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="view sub-photo-right-view">\n\t\t\t<a href="/account/upgrade/pro" class="find-out-more" data-track="ad_link_rail_panel" target="_blank">\n\t\t\t\tAd free browsing? Sign up for Flickr Pro\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</div>\n'},useData:!0}),a={};t.Array.each([],(function(n){var e=t.Template.get("hermes/"+n);e&&(a[n]=e)})),t.Template.register("hermes/sub-photo-moola-view",(function(n,r){return(r=r||{}).partials=r.partials?t.merge(a,r.partials):a,e(n,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-prbd-moola-position",(function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,a,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return' data-aa-adIdentity="'+n.escapeExpression("function"==typeof(o=null!=(o=r(e,"advertisingStitching")||(null!=l?r(l,"advertisingStitching"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"advertisingStitching",hash:{},data:t,loc:{start:{line:2,column:58},end:{line:2,column:82}}}):o)+'"'},3:function(n,l,e,a,t){return"upsell-fallback"},5:function(n,l,e,a,t){return'\t\t<a href="/account/upgrade/pro?feed"></a>\n'},7:function(n,l,e,a,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=r(e,"unless").call(null!=l?l:n.nullContext||{},null!=l?r(l,"showNonUSSticky"):l,{name:"unless",hash:{},fn:n.program(8,t,0),inverse:n.noop,data:t,loc:{start:{line:10,column:1},end:{line:12,column:12}}}))?o:""},8:function(n,l,e,a,t){var o,r=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,s=n.escapeExpression,u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t<p class="upgrade-to-pro-cta"><a href="'+s("function"==typeof(o=null!=(o=u(e,"upgradeProLink")||(null!=l?u(l,"upgradeProLink"):l))?o:i)?o.call(r,{name:"upgradeProLink",hash:{},data:t,loc:{start:{line:11,column:41},end:{line:11,column:59}}}):o)+'">'+s((u(e,"intlMessage")||l&&u(l,"intlMessage")||i).call(r,{name:"intlMessage",hash:{intlName:"common.UPGRADE_PRO_HIDE_ADS"},data:t,loc:{start:{line:11,column:61},end:{line:11,column:115}}}))+"</a></p>\n"},10:function(n,l,e,a,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=(r(e,"isFlipped")||l&&r(l,"isFlipped")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},"enable-ad-timer-lock",{name:"isFlipped",hash:{},fn:n.program(11,t,0),inverse:n.noop,data:t,loc:{start:{line:15,column:1},end:{line:19,column:15}}}))?o:""},11:function(n,l,e,a,t){var o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t<div class="navad-timer-container">\n\t\t\t<p class="navad-timer-text">'+n.escapeExpression((o(e,"intlMessage")||l&&o(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{adTimerStartCount:null!=l?o(l,"adTimerStartCount"):l,intlName:"common.AD_INTERSTITIAL_TIMER"},data:t,loc:{start:{line:17,column:31},end:{line:17,column:122}}}))+"</p>\n\t\t</div>\n"},compiler:[8,">= 4.3.0"],main:function(n,l,e,a,t){var o,r,i=null!=l?l:n.nullContext||{},s=n.hooks.helperMissing,u="function",c=n.escapeExpression,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<div data-aaad="true" data-aa-adunit="'+c(typeof(r=null!=(r=p(e,"adUnit")||(null!=l?p(l,"adUnit"):l))?r:s)===u?r.call(i,{name:"adUnit",hash:{},data:t,loc:{start:{line:1,column:38},end:{line:1,column:48}}}):r)+'"\n\t'+(null!=(o=(p(e,"isFlipped")||l&&p(l,"isFlipped")||s).call(i,"enable-ad-stitching",{name:"isFlipped",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:2,column:1},end:{line:2,column:97}}}))?o:"")+'\n\tclass="moola-container '+c(typeof(r=null!=(r=p(e,"class")||(null!=l?p(l,"class"):l))?r:s)===u?r.call(i,{name:"class",hash:{},data:t,loc:{start:{line:3,column:24},end:{line:3,column:33}}}):r)+" "+(null!=(o=p(e,"if").call(i,null!=l?p(l,"upsellFallback"):l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:3,column:34},end:{line:3,column:78}}}))?o:"")+'">\n\n'+(null!=(o=p(e,"if").call(i,null!=l?p(l,"upsellFallback"):l,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t,loc:{start:{line:5,column:1},end:{line:7,column:8}}}))?o:"")+"</div>\n"+(null!=(o=p(e,"if").call(i,null!=l?p(l,"upgradeProLink"):l,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.noop,data:t,loc:{start:{line:9,column:0},end:{line:13,column:7}}}))?o:"")+(null!=(o=p(e,"if").call(i,null!=l?p(l,"signedOut"):l,{name:"if",hash:{},fn:n.program(10,t,0),inverse:n.noop,data:t,loc:{start:{line:14,column:0},end:{line:20,column:7}}}))?o:"")},useData:!0}),a={};n.Array.each([],(function(l){var e=n.Template.get("hermes/"+l);e&&(a[l]=e)})),n.Template.register("hermes/prbd-moola-position",(function(l,t){return(t=t||{}).partials=t.partials?n.merge(a,t.partials):a,e(l,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-photo-well-media-interstitial-moola",(function(e,a){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,t,r,i){var l,n=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="photo-page-i-m-container">\n'+(null!=(l=e.invokePartial(n(r,"prbd-moola-position"),a,{name:"prbd-moola-position",hash:{upgradeProLink:null!=a?n(a,"upgradeProLink"):a,advertisingStitching:null!=a?n(a,"advertisingStitching"):a,signedOut:null!=a?n(a,"signedOut"):a,upsellFallback:null!=a?n(a,"upsellFallback"):a,adUnit:null!=a?n(a,"adUnit"):a,adTimerStartCount:null!=a?n(a,"adTimerStartCount"):a},data:i,indent:"\t",helpers:t,partials:r,decorators:e.decorators}))?l:"")+"</div>\n"},usePartial:!0,useData:!0}),r={};e.Array.each(["prbd-moola-position"],(function(a){var t=e.Template.get("hermes/"+a);t&&(r[a]=t)})),e.Template.register("hermes/photo-well-media-interstitial-moola",(function(a,i){return(i=i||{}).partials=i.partials?e.merge(r,i.partials):r,t(a,i)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-prbd-moola-position"]});YUI.add("photo-size-helper",(function(e,i){var n=require("hermes-core/flog")(i),t=[{name:"Square",length:75,key:"sq",suffix:"s",isSquare:!0},{name:"Large Square",length:150,key:"q",suffix:"q",isSquare:!0},{name:"Thumbnail",length:100,key:"t",suffix:"t"},{name:"Small",length:240,key:"s",suffix:"m"},{name:"Small 320",length:320,key:"n",suffix:"n"},{name:"Small 400",length:400,key:"w",suffix:"w"},{name:"Medium",length:500,key:"m",suffix:""},{name:"Medium 640",length:640,key:"z",suffix:"z"},{name:"Medium 800",length:800,key:"c",suffix:"c"},{name:"Large",length:1024,key:"l",suffix:"b"},{name:"Large 1600",length:1600,key:"h",suffix:"h"},{name:"Large 2048",length:2048,key:"k",suffix:"k"},{name:"X-Large 3K",length:3072,key:"3k",suffix:"3k"},{name:"X-Large 4K",length:4096,key:"4k",suffix:"4k"},{name:"VR 4K",length:4096,key:"f",suffix:"f",isVR:!0},{name:"X-Large 5K",length:5120,key:"5k",suffix:"5k"},{name:"X-Large 6K",length:6144,key:"6k",suffix:"6k"},{name:"Original",length:Number.MAX_VALUE,key:"o",suffix:"o",isOriginal:!0}];e.PhotoSizeHelper=function(i){return{getSizeConfig:function(e){return t.find((function(i){return i.key===e}))},getSize:function(e,i){return(i=i||[]).find((function(i){return i.key===e}))},getLargerSizeByScale:function(e,i){var n=this.getSizeConfig(e);return i=i||1.5,t.find((function(e){return!this.isASpecialSize(e)&&e.length>=i*n.length}),this)},isASpecialSize:function(e){return!!e.isSquare||(!!e.isVR||!!e.isOriginal)},getPhotoAspectRatio:function(e){var i=this.getBiggestGeneratedSize(e);return i.width/i.height},getBiggestGeneratedSize:function(e){var i,n=[];for(i in e)"o"!==i&&n.push(e[i]);return n.sort((function(e,i){return e.width<=i.width?1:-1})),n[0]},getSizeToFit:function(i,t,r){var s,u,a,h=t.width,f=t.height,g=!!r.cropToFit,o=r.includeSquare,l=r.excludeSizes||["o"],c=r.includeSizes,S=this.isPhotoSquare(i);if(void 0===r.includeSizes)try{c=Object.keys(i)}catch(e){n.warn("getSizeToFit with invalid sizes",{err:e,sizes:i})}return e.Object.each(i,(function(e,i){var n,t,r,k,m;e&&-1===l.indexOf(i)&&c.indexOf(i)>-1&&(o||!this.isSquareType(i)||S)&&(n=parseInt(e.width,10),t=parseInt(e.height,10),(g&&n>=h&&t>=f||!g&&(n>=h||t>=f))&&(r=!0),r&&(s?t<parseInt(s.height,10)&&(s=e):s=e),u?(k=parseInt(u.width,10),m=parseInt(u.height,10),(n>k||t>m)&&(u=e)):u=e),a=s||u}),this),a},isSquareType:function(e){return["sq","q"].indexOf(e)>-1},hasSquareDimensions:function(e){return parseInt(e.width,10)/parseInt(e.height,10)==1},isPhotoSquare:function(i){var n=!0;return e.Object.some(i,(function(e,i){if(e&&e.width&&e.height&&1!==parseInt(e.width,10)/parseInt(e.height,10))return n=!1,!0}),this),n},parseApiSizes:function(i,n){return e.APIHelper.response.parsePhotoSize(i,n)}}}}),"@VERSION@",{requires:["api-helper"]});YUI.add("photo-well-media-scrappy-view",(function(e,t){var i=require("hermes-core/flog")(t),n=new e.SubscriptionsHelper,o={photo:{render:function(){var e,t,i,n,o,a=this.get("photo"),s="",r=a.getValue("ascendingSizes"),h=[];for(var l in"o"===r[r.length-1].key&&r.pop(),r)t=r[l-1],e=r[l],this.photoSizeHelper.getSizeConfig(e.key),(o={}).srcset=e.url+" 1x",(n=this.photoSizeHelper.getLargerSizeByScale(e.key,1.3))&&(i=r.find((function(e){return e.key===n.key})))&&(o.srcset+=", "+i.url+" "+i.width/e.width+"x"),t||(t={width:0,height:0}),o.media="(min-width: "+(t.width+1)+"px) and (min-height: "+(t.height+1+150)+"px)",o.dataSize=e.key,o.dataWidth=e.width,o.dataHeight=e.height,h.push(o);return h.reverse(),a.getValue("owner")&&(s=""===a.getValue("title").trim()?this.intlMessage({intlName:"common.UNTITLED"}):a.getValue("title"),s+=", "+this.intlMessage({intlName:"common.BY_USER",user:a.getValue("owner").getValue("username")})),this.setContainerWithTemplate("photo-well-media-scrappy",{sources:h,src:this.photoSizeHelper.getSize("t",r).url,imgAltText:s,needsInterstitial:a.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:!1,isMinor:this.appContext.getViewer().isMinor}),this}},video:{render:function(){var e=this.get("photo"),t=this.getPhotoForDisplay({excludeSizes:[]}),i=t.url;return this.appContext.flipper.isFlipped("disable-video-playback")&&(i="/images/en-us/video-unavailable/m.png"),!this.player||e.getValue("isVideoPending")||e.getValue("isVideoFailed")?(this.setContainerWithTemplate("photo-well-media-scrappy",{width:t.width,height:t.height,src:i,needsInterstitial:e.getValue("needsInterstitial"),isVideo:!0,isSignedIn:this.appContext.getViewer().signedIn,"zoom-view":""}),this):(e.getValue("isVideoPending")||e.getValue("isVideoFailed")||(this.player.dimension?(this.player.dimension("width",t.width),this.player.dimension("height",t.height)):this.player.resize(t.width,t.height)),this)}},ad:{render:function(){var t=e.config.flickr.moola.positions.interstitials[0],i={},o=this.appContext.viewportData.getWidth(),a=e.config.flickr.moola.ad_breakpoint_mobile_desktop;return this.adEventStitch=this.appContext.adManager.getHashedAdValue(this.appContext.adManager.getAdPositioning(this.get("container"))),this.adId=e.guid(),i.signedOut=!this.appContext.getViewer().signedIn,i.adTimerStartCount=t.ad_timer_start_value,i.adUnit=t[o<a?"ad_unit_mobile":"ad_unit_desktop"],i.advertisingStitching=this.adEventStitch,i.upgradeProLink=n.getProLandingPageUrl(n.UTM_HIDE_ADS),this.adUnit=i.adUnit,this.setContainerWithTemplate("photo-well-media-interstitial-moola",i),this}}};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"zoom-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"vr-overlay-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,destinationContainer:".photo-well-media-scrappy-view",disabled:function(){return!this.appContext.flipper.isFlipped("enable-vr")}}},initializer:function(t){return this.photoId=t.photoId,this.isAd=!!t.ad,this.geo=t.geo,this.adSlots=[],this.photoSizeHelper=new e.PhotoSizeHelper(this.appContext),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var t=this;return this.appContext.getModel("photo-models",t.photoId).then((function(i){if(t.set("photo",i),i.getValue("isVideo"))return new e.Promise((function(t,i){e.use("flickr-video-player",(function(){t()}))}))}))},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?o.ad.render.call(this):this.get("photo").getValue("isVideo")?o.video.render.call(this):o.photo.render.call(this),!YUI.Env.isServer&&this.subviews["vr-overlay-view"]&&this.subviews["vr-overlay-view"].get("canVr")&&(this.canVR=!0,this.subviews["zoom-view"]&&this.subviews["zoom-view"].destroy({remove:!0})),this.get("photo").getValue("needsInterstitial")?this.get("container").addClass("has-interstitial"):this.get("container").removeClass("has-interstitial"),this},handleInterstitialDismissButtonClick:function(t){var n=this,o=this.get("personPreferences"),a=this.get("photo"),s=a.getValue("safetyLevel");e.rapidTracker.beacon(this.name,"restrictedContentInterstitialClick"),o.setValue("safeSearch",s),o.registry.remoteUpdate(n.appContext.auth.user.nsid).then((function(e){a.registry.attributeSearch({needsInterstitial:!0}).forEach((function(e){a.registry.getValue(e,"safetyLevel")<=o.getValue("safeSearch")&&a.registry.setValue(e,"needsInterstitial",!1)})),n.buildContainer(),n.fire("subviewViewEvent","photoWellResized")}),(function(e){i.error({err:e}),n.onError(n.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))}))},onParentViewEvent:function(e,t){if(t&&"photoWellResized"===t[0]){var i=this.get("photo");this.isAd||i.getValue("isVideo")||i.getValue("needsInterstitial")||this.rightSizePhotoMedia(t[1])}},rightSizePhotoMedia:function(e){var t=this.get("container"),i=(t.all("source"),t.one("#photoWellDynamicSizer"));i&&i.insert(":root { --belowPhotoWellHeight: "+(window.innerHeight-e-50)+"px; }","replace")},activate:function(){var t=this;return!this.get("photo").getValue("isVideo")||this.get("photo").getValue("isVideoPending")||this.get("photo").getValue("isVideoFailed")||(this.player=new e.FlickrVideoPlayer({container:t.get("container").one(".videoplayer"),model:t.get("photo"),appContext:t.appContext,videoNode:e.one("#video_1")?e.one("#video_1").getDOMNode():null,controlBar:{fullscreenToggle:!1}}),this.player.init(),this.on("destroy",(function(){t.player&&(t.player.destroy(),t.player=null)}))),this.get("photo").getValue("needsInterstitial")||this.registerEventHandler(e.on("flickr:photo-media-well-update",(function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()}))),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",this.appContext.auth.user.nsid).then((function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&t.get("container").one(".restricted-interstitial-message button")&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t))})),this.appContext.flipper.isFlipped("enable-sticky-ads")&&this.appContext.allowThirdPartyContent&&this.geo&&"US"===this.geo.countryCode&&this.appContext.adManager.handleInfolinks(this.get("photo").getValue("owner").getValue("isPro"),this.isAd),this.isAd&&(t.appContext.adManager.processAdsOnPage(),t.adUnit&&t.appContext.adManager.signalAdRequest(t),e.once("adPageChange",(function(){t.fire("subviewViewEvent","adPageTimeoutStart")}))),this},showUpsell:function(){var e=this.get("container"),t=e.one("#interstitial-photo-upsell"),i=e.one("iframe");t&&t.addClass("show-upsell"),i&&i.setStyle("display","none")},onError:function(t){new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:this.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,classList:"scrappy-dialog"}).show()},getPhotoForDisplay:function(e){var t,i,n,o=this.getCanvasSize(),a=this.getPixelRatio();return e&&e.canvasSize&&(o=e.canvasSize),t=this.get("photo").getSizeToFit(o,e),i=Math.min(o.height/a,t.height),n=Math.min(o.width/a,t.width/t.height*i),i=Math.min(i,t.height/t.width*n),{width:Math.round(n),height:Math.round(i),url:t.url,pixelRatio:t.width/n}},getCanvasSize:function(){var e,t,i,n,o=this.getPixelRatio(),a=this.get("container"),s={width:500,height:500};return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(t=this.get("container").ancestor(),i=a.getStyle("paddingTop")?parseInt(a.getStyle("paddingTop").match(/[0-9]+/)[0],10):0,n=a.getStyle("paddingBottom")?parseInt(a.getStyle("paddingBottom").match(/[0-9]+/)[0],10):0,40,40,t&&((e=t.get("region")).height=parseInt(t.getStyle("height").match(/[0-9]+/)[0],10)-(i+n),e.width=this.appContext.viewportData.viewport.width-80)):e=this.get("cachedCanvasSize"),this.appContext.viewportData.viewport.width>0&&(s={width:this.appContext.viewportData.viewport.width,height:this.appContext.viewportData.viewport.height-240}),e||(e={top:0,left:0,bottom:500,right:500,width:s.width,height:s.height}),e.height*=o,e.width*=o,e},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})}),"@VERSION@",{requires:["flickr-view","moment","vr-overlay-view","zoom-view","hermes-template-photo-well-media-scrappy","hermes-template-sub-photo-moola-view","hermes-template-photo-well-media-interstitial-moola","subscriptions-helper","photo-size-helper"],optional:["photo-models"],langBundles:["common","photo-page-scrappy"]});