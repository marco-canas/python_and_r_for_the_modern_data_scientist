YUI.add("gallery-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-galleries-getPhotos"].run(t,this.appContext)},create:function(t,r){return e.ModelCreators["flickr-galleries-create"].run(t,r)},addPhoto:function(t,r){return e.ModelCreators["flickr-galleries-addPhoto"].run(t,r)},removePhoto:function(t,r){return e.ModelDeletors["flickr-galleries-removePhoto"].run(t,r)}},addPhoto:function(e,t){return this.getValue(e,"photoPageList").hasMaxBoundary()&&this.getValue(e,"photoPageList").appendToList(t),this.getValue(e,"photoContextList").hasMaxBoundary()&&this.getValue(e,"photoContextList").appendToList(t),this},removePhoto:function(e,t){return this.getValue(e,"photoPageList").removeFromList(t.getValue("id")),this.getValue(e,"photoContextList").removeFromList(t.getValue("id")),this},hasPhoto:function(e,t){return this.getValue(e,"photoPageList").getFromListByID(t)||this.getValue(e,"photoContextList").getFromListByID(t)},getPrimaryUrlToFit:function(t,r){this.getValue(t,"primaryPhotoSizes");var i=e.PhotoModelHelper.getSizeToFit(t,{height:r?r.width:75,width:r?r.height:75},e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0}));return i?i.src:""},attributes:{compoundId:{validator:function(t,r){return e.Lang.isString(t)&&t.indexOf("-")>-1}},displayType:{readOnly:!0,defaultFn:function(){return"gallery"}},title:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){var r=e.AttributeHelpers.coerceString(t);return r=r.replace(/\\'/,"'").replace(/\\"/,'"').replace(/\\\\/,"\\")},defaultValue:""},description:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},owner:{isModel:!0},photoPageList:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-galleries-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-galleries-getContext"],listItemIdField:"photoId"}},photoCount:{validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},videoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},itemCount:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){return this.getValue(e,"photoCount")+this.getValue(e,"videoCount")}},photoCountDisplay:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),r=this.getValue(e,"videoCount"),i="";return 0===t&&0===r?i=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):1===t&&0===r?i=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&0===r?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):0===t&&1===r?i=this.intlMessage({intlName:"models.ONE_VIDEO"}):1===t&&1===r?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&1===r?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):0===t&&r>1?i=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:r}):1===t&&r>1?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:r}):t>1&&r>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:r})),i}},viewCount:{validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},commentCount:{validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},primary:{},primaryPhotoSizes:{},bestIconURL:{readOnly:!0,derivedBy:["primaryPhotoSizes"],defaultFn:function(e){return this.getPrimaryUrlToFit(e)||void 0}},url:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"owner");return t?"/photos/"+t.getValue("pathAlias")+"/galleries/"+e+"/":void 0}},urlSuffix:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){return"gallery-"+this.getValue(e,"owner").getValue("pathAlias")+"-"+e}},coverPhotosData:[]}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-galleries-getPhotos-fetcher","flickr-galleries-getContext-fetcher","flickr-galleries-addPhoto-creator","flickr-galleries-removePhoto-deletor","flickr-galleries-create-creator"],langBundles:["models"]});YUI.add("hermes-lang-shared-entity_es-us",(function(e,t){e.Intl.add("hermes/shared-entity","es-US",{USERNAME_HAS_SHARED_PHOTOS_ONLY:[{type:0,value:"ยก"},{type:1,value:"username"},{type:0,value:" ha compartido "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" foto"}]},other:{value:[{type:7},{type:0,value:" fotos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" contigo!"}],USERNAME_HAS_SHARED_VIDEOS_ONLY:[{type:0,value:"ยก"},{type:1,value:"username"},{type:0,value:" ha compartido "},{type:6,value:"videoCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" contigo!"}],USERNAME_HAS_SHARED_PHOTOS_VIDEOS:[{type:0,value:"ยก"},{type:1,value:"username"},{type:0,value:" ha compartido "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" foto"}]},other:{value:[{type:7},{type:0,value:" fotos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" "},{type:6,value:"videoCount",options:{one:{value:[{type:0,value:"y "},{type:7},{type:0,value:" video"}]},other:{value:[{type:0,value:"y "},{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" contigo!"}],OWNER_HAS_SHARED_PHOTOS_ONLY:[{type:0,value:"Has compartido "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" foto"}]},other:{value:[{type:7},{type:0,value:" fotos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],OWNER_HAS_SHARED_VIDEOS_ONLY:[{type:0,value:"Has compartido "},{type:6,value:"videoCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],OWNER_HAS_SHARED_PHOTOS_VIDEOS:[{type:0,value:"Has compartido "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" foto"}]},other:{value:[{type:7},{type:0,value:" fotos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" "},{type:6,value:"videoCount",options:{one:{value:[{type:0,value:"y "},{type:7},{type:0,value:" video"}]},other:{value:[{type:0,value:"y "},{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],VIEW_YOUR_SHARING_HISTORY:[{type:0,value:"Ver tu historial de datos compartidos"}]})}),"@VERSION@",{requires:["intl"]});YUI.add("photo-sets-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext)}},attributes:{id:{},sets:{isListProxy:!0},total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})}),"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getAllContexts-fetcher"]});YUI.add("flickr-photosets-addPhoto-creator",(function(o,e){"use strict";o.namespace("ModelCreators")["flickr-photosets-addPhoto"]={run:function(t,s){var l={full_response:1},d=[],u=t.isMultiplePhotos?"photo_ids":"photo_id",h=t.photoID.split(",").length;return l[u]=t.photoID,l.photoset_id=t.setID,t.gpCode&&(l.gp_code=t.gpCode),t.gpOwner&&(l.gp_owner=t.gpOwner),t.shareCode&&(l.share_code=t.shareCode),t.includeHiddenSets&&(l.extras="hidden_sets",l.user_id=t.userId),d=[s.callAPI("flickr.photosets.addPhoto",l),s.getModel("set-models",t.setID),s.getModelRegistry("photo-sets-models"),s.getModelRegistry("photo-contexts-models")],t.isMultiplePhotos||d.push(s.getModel("photo-models",t.photoID)),o.Promise.all(d).then((function(e){var s,l=e[0],d=e[1],u=e[2],i=e[3],p=l.errors,r=l.errors?l.errors.length:0;if(h-=r,"ok"===l.stat){if(t.isMultiplePhotos)d&&t.updateItemCounts&&(d.setValue("photoCount",d.getValue("photoCount")+t.numberOfPhotosSelected),d.setValue("videoCount",d.getValue("videoCount")+t.numberOfVideosSelected));else if(s=e[4],d&&!d.hasPhoto(s.getValue("id")))if(d.addPhoto(s),s.getValue("isVideo"))d.setValue("videoCount",d.getValue("videoCount")+1);else if(d.setValue("photoCount",d.getValue("photoCount")+1),o.Snowplough){var n={id:l.photoset.id,photoIds:[s.getValue("id")]};o.Snowplough.sendStructuredEvent({category:"album",action:"add_photo"},o.Snowplough.getAlbumContext(n))}if(u.exists(t.photoID)&&!u.getValue(t.photoID,"sets").getFromListByID(d.getValue("id"))&&(u.getValue(t.photoID,"sets").prependToList(d),u.setValue(t.photoID,"total",u.getValue(t.photoID,"total")+h)),i.exists(t.photoID)&&!i.getValue(t.photoID,"contexts").getFromListByID(d.getValue("id"))&&(i.setValue(t.photoID,"totalSets",i.getValue(t.photoID,"totalSets")+h),i.getValue(t.photoID,"contexts").push(d)),t.isMultiplePhotos){var a=t.photosSelectedIds;if(r&&p.forEach((function(o){-1!==t.photosSelectedIds.indexOf(o.photo_id)?(d.setValue("photoCount",d.getValue("photoCount")-1),a.splice(a.indexOf(o.photo_id),1)):d.setValue("videoCount",d.getValue("videoCount")-1)})),o.Snowplough&&a.length>1){var g={id:l.photoset.id,photoIds:a};o.Snowplough.sendStructuredEvent({category:"album",action:"add_photo"},o.Snowplough.getAlbumContext(g))}return{errors:p,setModel:d}}return d}}),function(t){return o.FetcherErrorLogger(e),t}.bind(this))}}}),"@VERSION@",{requires:["flickr-promise"],optional:["set-models","photo-models","photo-sets-models","photo-contexts-models"]});YUI.add("flickr-photosets-getList-fetcher",(function(e,t){"use strict";e.namespace("ListFetchers")["flickr-photosets-getList"]={run:function(s,o){var a=this,r=this._processParams(s);return e.Promise.all([o.callAPI("flickr.photosets.getList",r,!0),o.getModelRegistry("sets-models"),o.getModelRegistry("set-models"),o.getModel("person-models",s.id||{pathAlias:s.pathAlias})]).then((function(e){return a._processResponse(e,s)}),e.FetcherErrorLogger(t))},_processParams:function(t){var s={primary_photo_extras:e.APIHelper.request.getRebootAlbumsListExtras(),page:t.page,per_page:t.perPage||500,get_user_info:1,extras:"can_share,can_download"};if(t.id)s.user_id=t.id;else{if(!t.pathAlias)throw new Error("[flickr-favorites-getList-fetcher] `id` or `pathAlias` is required.");s.path_alias=t.pathAlias}return s},_processResponse:function(t,s){var o,a,r=t[0],i=t[1],p=t[2],n=t[3],l=r.photosets,h={},d=n.getValue("id"),c=[];if(l)return l.photoset&&e.Array.each(l.photoset,(function(t,s){if(0!==t.visibilityCanSeeSet){var o={id:t.id,title:t.title.content,description:t.description.content,owner:n,primary:t.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(t),isAutoUploadSet:t.autoUpload,primaryNeedsInterstitial:t.needsInterstitial,photoCount:t.photos,videoCount:t.videos,publicPhotosCount:t.countPhotosPublic,totalCount:parseInt(t.photos,10)+parseInt(t.videos,10),viewCount:t.countViews,canShare:t.canShare+(t.canShareDeep||0),canDownload:t.canDownload};c.push(p.addOrUpdate(o))}})),h={id:d,pathAlias:n.getValue("pathAlias"),totalItems:r.photosets.total},o=parseInt(r.photosets.perpage),a=parseInt(r.photosets.page),h.albumsList={perPage:o,page:a,pageContent:c,totalItems:r.photosets.total,totalPages:Math.ceil(r.photosets.total/o)},i.addOrUpdate(h),c}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["sets-models","set-models","person-models"]});YUI.add("sets-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ListFetchers["flickr-photosets-getList"].run(e,this.appContext)}},attributes:{id:{},pathAlias:{},albumsList:{isCollection:!0,pageFetch:{listFetcher:t.ListFetchers["flickr-photosets-getList"]}},totalItems:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-getList-fetcher"]});YUI.add("flickr-photosets-removePhoto-deletor",(function(e,t){"use strict";e.namespace("ModelCreators")["flickr-photosets-removePhoto"]={run:function(o,s){var l={full_response:1},i=[],u=o.isMultiplePhotos?"photo_ids":"photo_id",r=o.photoID.split(",").length;return l[u]=o.photoID,l.photoset_id=o.setID,o.includeHiddenSets&&(l.extras="hidden_sets",l.user_id=o.userId),i=[s.callAPI("flickr.photosets.removePhoto",l),s.getModel("set-models",o.setID),s.getModel("sets-models",s.getViewer().nsid,{page:1,perPage:s.flipper.isFlipped("enable-sets-list-loading-fix")||o.includeHiddenSets?10:500}),s.getModelRegistry("photo-sets-models"),s.getModelRegistry("photo-contexts-models")],o.isMultiplePhotos||i.push(s.getModel("photo-models",o.photoID)),e.Promise.all(i).then((function(e){var t,s=e[0],l=e[1],i=e[2],u=e[3],d=e[4];if("ok"===s.stat)return d.exists(o.photoID)&&d.getValue(o.photoID,"contexts").getFromListByID(o.setID)&&(d.setValue(o.photoID,"totalSets",d.getValue(o.photoID,"totalSets")-r),d.getValue(o.photoID,"contexts").removeFromList(o.setID)),u.exists(o.photoID)&&u.getValue(o.photoID,"sets").getFromListByID(o.setID)&&(u.setValue(o.photoID,"total",u.getValue(o.photoID,"total")-r),u.getValue(o.photoID,"sets").removeFromList(o.setID)),l&&(o.isMultiplePhotos?l&&o.updateItemCounts&&(l.setValue("photoCount",l.getValue("photoCount")-o.numberOfPhotosSelected),l.setValue("videoCount",l.getValue("videoCount")-o.numberOfVideosSelected)):(t=e[5],l.hasPhoto(t.getValue("id"))&&l.removePhoto(t),t.getValue("isVideo")?l.setValue("videoCount",l.getValue("videoCount")-r):l.setValue("photoCount",l.getValue("photoCount")-r)),l.getValue("totalCount")<1&&!o.includeHiddenSets)?(i.getValue("albumsList").remove(o.setID),l.registry.remove(o.setID),null):l}),e.FetcherErrorLogger(t))}}}),"@VERSION@",{requires:["flickr-promise"],optional:["set-models","photo-models","sets-models","photo-sets-models","photo-contexts-models"]});YUI.add("flickr-photosets-delete-deletor",(function(e,r){"use strict";e.namespace("ModelDeletors")["flickr-photosets-delete-deletor"]={run:function(o,t){return o.photoset_id=o.setID,o.gpCode&&(o.gp_code=o.gpCode),o.gpOwner&&(o.gp_owner=o.gpOwner),o.shareCode&&(o.share_code=o.shareCode),t.callAPI("flickr.photosets.delete",o).then((function(e){if(1===e.code)throw new Error(e)})).catch(e.FetcherErrorLogger(r))}}}),"@VERSION@",{requires:["flickr-promise"]});