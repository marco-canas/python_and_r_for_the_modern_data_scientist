YUI.add("hermes-template-print-button",(function(n,e){var t=n.Template.Handlebars.revive({1:function(n,e,t,l,r){var o,a=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return" "+n.escapeExpression("function"==typeof(o=null!=(o=a(t,"iconSize")||(null!=e?a(e,"iconSize"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"iconSize",hash:{},data:r,loc:{start:{line:3,column:52},end:{line:3,column:64}}}):o)},compiler:[8,">= 4.3.0"],main:function(n,e,t,l,r){var o,a=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="print-button-container">\n\t<a role="button" class="print-button">\n\t\t<svg class="icon icon-cart_hollow'+(null!=(o=a(t,"if").call(null!=e?e:n.nullContext||{},null!=e?a(e,"iconSize"):e,{name:"if",hash:{},fn:n.program(1,r,0),inverse:n.noop,data:r,loc:{start:{line:3,column:35},end:{line:3,column:71}}}))?o:"")+'"><use xlink:href="#icon-cart_hollow"></use></svg>\n\t</a>\n</div>'},useData:!0}),l={};n.Array.each([],(function(e){var t=n.Template.get("hermes/"+e);t&&(l[e]=t)})),n.Template.register("hermes/print-button",(function(e,r){return(r=r||{}).partials=r.partials?n.merge(l,r.partials):l,t(e,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-print-icon-tooltip",(function(e,n){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,l){var s=null!=n?n:e.nullContext||{},i=e.hooks.helperMissing,r=e.escapeExpression,o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="print-icon-tooltip-container">\n\t<header>\n\t\t<h3>'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"common.NEW"},data:l,loc:{start:{line:3,column:6},end:{line:3,column:43}}}))+'</h3>\n\t\t<svg class="close-x-button"><use xlink:href="#icon-close"></use></svg>\n\t</header>\n\t<div class="print-icon-description">\n\t\t<span>'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"prints.PRINT_TOOLTIP_TEXT_1"},data:l,loc:{start:{line:7,column:8},end:{line:7,column:62}}}))+'</span>\n\t\t<a href="/prints">'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"common.LEARN_MORE"},data:l,loc:{start:{line:8,column:20},end:{line:8,column:64}}}))+'</a>\n\t</div>\n\t<div class="print-icon-fine-print">'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"prints.PRINT_TOOLTIP_TEXT_2"},data:l,loc:{start:{line:10,column:36},end:{line:10,column:90}}}))+"</div>\n</div>\n"},useData:!0}),a={};e.Array.each([],(function(n){var t=e.Template.get("hermes/"+n);t&&(a[n]=t)})),e.Template.register("hermes/print-icon-tooltip",(function(n,l){return(l=l||{}).partials=l.partials?e.merge(a,l.partials):a,t(n,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-prepare-print-modal",(function(e,t){var a=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,a,n,l){var s,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,o=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="prepare-print-modal-container loading">\n\t<div class="loading-container">\n\t\t<span class="preparing-text">'+o((c(a,"intlMessage")||t&&c(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"prints.PREPARING_YOUR_PHOTO"},data:l,loc:{start:{line:3,column:31},end:{line:3,column:85}}}))+'</span>\n\t\t<span class="flickr-balls-container">\n'+(null!=(s=e.invokePartial(c(n,"flickr-balls"),t,{name:"flickr-balls",data:l,indent:"\t\t\t",helpers:a,partials:n,decorators:e.decorators}))?s:"")+'\t\t</span>\n\t</div>\n\t<div class="error-container">\n\t\t<h1>'+o((c(a,"intlMessage")||t&&c(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.OOPS"},data:l,loc:{start:{line:9,column:6},end:{line:9,column:44}}}))+'</h1>\n\t\t<p class="error-message"></p>\n\t\t<div class="button-container">\n\t\t\t<button class="mini alt cancel-button">'+o((c(a,"intlMessage")||t&&c(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.CANCEL"},data:l,loc:{start:{line:12,column:42},end:{line:12,column:82}}}))+'</button>\n\t\t\t<button class="mini action retry-button">'+o((c(a,"intlMessage")||t&&c(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.RETRY"},data:l,loc:{start:{line:13,column:44},end:{line:13,column:83}}}))+"</button>\n\t\t</div>\n\t</div>\n</div>"},usePartial:!0,useData:!0}),n={};e.Array.each(["flickr-balls"],(function(t){var a=e.Template.get("hermes/"+t);a&&(n[t]=a)})),e.Template.register("hermes/prepare-print-modal",(function(t,l){return(l=l||{}).partials=l.partials?e.merge(n,l.partials):n,a(t,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-flickr-balls"]});YUI.add("prepare-print-modal-view",(function(e,r){require("hermes-core/flog")(r);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){},buildContainer:function(){this.setContainerWithTemplate("prepare-print-modal")},activate:function(){var e=this,r=this.get("container");this.contentContainer=r.one(".prepare-print-modal-container"),this.loadingContainer=r.one(".loading-container"),this.errorContainer=r.one(".error-container"),this.errorTextContainer=this.errorContainer.one(".error-message"),this.errorRetryButton=this.errorContainer.one("button.retry-button"),this.errorCancelButton=this.errorContainer.one("button.cancel-button"),this.registerEventHandler(this.errorRetryButton.on("click",(function(){e.fire("retryClicked")}))),this.registerEventHandler(this.errorCancelButton.on("click",(function(){e.fire("closeClicked")})))},showError:function(e){this.contentContainer.removeClass("loading"),this.contentContainer.addClass("error"),e&&this.errorTextContainer.set("text",e)},showLoading:function(){this.contentContainer.addClass("loading"),this.contentContainer.removeClass("error")}})}),"@VERSION@",{requires:["flickr-view","hermes-template-prepare-print-modal"],langBundles:["common","prints"]});YUI.add("hermes-lang-prints_es-us",(function(e,a){e.Intl.add("hermes/prints","es-US",{PRINTS:[{type:0,value:"Impresiones"}],SIGNUP_MODAL_TITLE:[{type:0,value:"¡Obtén impresiones fabulosas!"}],SIGNUP_MODAL_MESSAGE:[{type:0,value:"Únete a Flickr para tener acceso a nuestros increíbles laboratorios de impresión para todas tus fotos."}],GET_STARTED:[{type:0,value:"Comenzar"}],PRINTS_AND_GIFTS:[{type:0,value:"Impresiones y cuadros decorativos"}],VIEW_CART:[{type:0,value:"Ver carrito"}],VIEW_CART_WITH_COUNT:[{type:0,value:"Ver carrito ("},{type:1,value:"count"},{type:0,value:")"}],BUY_PRINTS:[{type:0,value:"Comprar impresiones"}],PHOTO_BOOKS_MENU_TEXT:[{type:0,value:"Álbumes de fotos"}],CHOOSE_PHOTO_TO_GET_PRINTS:[{type:0,value:"Elige una foto para crear impresiones y cuadros decorativos."}],BUY_PRINTS_MENU_TEXT:[{type:0,value:"Comprar impresiones"}],CHOOSE_YOUR_PHOTO_TO_GET_PRINTS:[{type:0,value:"Elige una de tus fotos para obtener impresiones y cuadros decorativos."}],LEARN_MORE_THEN_FEEDBACK:[{type:0,value:'<a class="learn-link" href="'},{type:1,value:"learnUrl"},{type:0,value:'" target="_blank">Aprende más</a> y luego <a class="feedback-link" href="'},{type:1,value:"feedbackUrl"},{type:0,value:'" target="_blank">¡dinos qué te parece!</a>'}],GET_PRINTS:[{type:0,value:"Obtener impresiones"}],THANKS_FOR_YOUR_ORDER:[{type:0,value:"¡Gracias por tu pedido!"}],YOUR_ORDER_NUMBER_IS:[{type:0,value:'Tu número de pedido es <a class="order-link" href="'},{type:1,value:"orderUrl"},{type:0,value:'" target="_blank">'},{type:1,value:"orderNum"},{type:0,value:"</a>."}],YOULL_RECEIVE_ORDER_EMAIL:[{type:0,value:'Recibirás un correo electrónico con los detalles de tu pedido en <span class="email-span">'},{type:1,value:"email"},{type:0,value:"</span>."}],HAVE_QUESTIONS_LINE:[{type:0,value:'¿Tienes preguntas? Dale un vistazo a <a class="help-link" href="'},{type:1,value:"helpUrl"},{type:0,value:'" target="_blank">nuestro Centro de ayuda</a>.'}],WE_WELCOME_FEEDBACK_HERE:[{type:0,value:'Recibimos <a class="feedback-link" href="'},{type:1,value:"feedbackUrl"},{type:0,value:'" target="_blank">tus comentarios aquí</a>.'}],PRINT_TOOLTIP_TEXT:[{type:0,value:"Ahora puedes obtener impresiones y cuadros decorativos de tus propias fotos. (Tienes este servicio disponible solo para tus fotos)"}],PRINT_TOOLTIP_TEXT_1:[{type:0,value:"Ahora puedes obtener impresiones y cuadros decorativos de tus propias fotos."}],PRINT_TOOLTIP_TEXT_2:[{type:0,value:"Tienes este servicio está disponible solo para tus fotos."}],GET_PRINTS_WALL_ART_TITLE:[{type:0,value:"Obtén impresiones y cuadros decorativos de tus fotos"}],GET_PRINTS_WALL_ART_DESCRIPTION:[{type:0,value:"Elije entre impresiones sobre metal, lienzos de tela o papel en muchos estilos y tamaños."}],SELECT_FROM_YOUR_PHOTOS:[{type:0,value:"Selecciona tus fotos"}],ENGLISH_LANGUAGE_AHEAD:[{type:0,value:"De aquí en adelante esta página está solo en inglés."}],ORDERING_IS_ENGLISH_ONLY:[{type:0,value:"Por el momento, nuestro proceso para solicitar pedidos se encuentra disponible solo en inglés. Continúa si te sientes cómodo leyendo en inglés."}],CONTINUE_IN_ENGLISH:[{type:0,value:"Continuar en inglés"}],PRINTS_AND_WALL_ART:[{type:0,value:"Impresiones y cuadros decorativos"}],GET_STUNNING_WALL_ART:[{type:0,value:"Obtén increíbles cuadros decorativos e impresiones de alta calidad de tus fotografías"}],GET_STUNNING_ALL:[{type:0,value:"Increíbles cuadros decorativos e impresiones de alta calidad"}],CHOOSE_PHOTOS:[{type:0,value:"Elige tus fotos"}],METAL_PRINTS:[{type:0,value:"Impresiones sobre metal"}],METAL_PRINTS_DESCRIPTION:[{type:0,value:"Las impresiones sobre metal ofrecen efectos de color e intensidad que producen un nivel de profundidad y claridad único que no encontrarás en ningún otro cuadro decorativo con fotografías. Si quieres una impresión que sea tan llamativa como tus fotos más épicas, ¡lo que necesitas son impresiones sobre metal!"}],PAPER_PRINTS:[{type:0,value:"Impresiones en papel"}],PAPER_PRINTS_DESCRIPTION:[{type:0,value:"Las impresiones sobre papel son una forma tradicional de presumir y compartir tus fotos favoritas. Desde paquetes de fotografías en 4x6, hasta piezas representativas para enmarcar, podrás encontrar el tamaño y acabado de papel perfecto para imprimir cualquier foto."}],CANVAS_PRINTS:[{type:0,value:"Impresiones sobre lienzos de tela"}],CANVAS_PRINTS_DESCRIPTION:[{type:0,value:"Agrégale un toque de elegancia a tu casa, oficina o cualquier otro espacio que necesite un cuadro en lienzo impreso. Con formas y tamaños perfectos para cualquier lugar donde quieras colgar tus fotos, tus imágenes se verán espectaculares."}],WHO_CAN_PRINT_PHOTOS_QUESTION:[{type:0,value:"¿Quién puede imprimir mis fotos?"}],WHO_CAN_PRINT_PHOTOS_ANSWER:[{type:0,value:"Solo tú puedes imprimir tus fotos en Flickr. Las personas que visiten tu cuenta no verán la opción de comprar impresiones de tus fotos."}],WHO_CAN_PRINT_PHOTOS_ANSWER_CONTROL:[{type:0,value:"Tú tienes el control total de quién puede imprimir tus fotos. Imprime para ti, comparte con tus amigos o con el mundo, y disfruta de la satisfacción de saber que los demás disfrutan y aprecian tus fotos."}],WHO_MAKES_PRINTS_QUESTION:[{type:0,value:"¿Quién manufactura las impresiones y cuadros decorativos?"}],WHO_MAKES_PRINTS_ANSWER:[{type:0,value:"Flickr Prints se beneficia de los años de experiencia que SmugMug tiene imprimiendo imágenes hermosas. Dependiendo de tu ubicación, tus impresiones pueden provenir de Bay Photo, White House Custom Color o Loxley Colour. Todos los laboratorios con los que trabajamos tienen excelentes sistemas de reproducción a color y una excelente reputación."}],HOW_LONG_SHIP_QUESTION:[{type:0,value:"¿Cuánto tarda el envío?"}],HOW_LONG_SHIP_ANSWER:[{type:0,value:"Hacemos envíos a todo el mundo, incluyendo más de 160 países. Sin importar dónde estés, haremos que recibas tus impresiones lo más pronto posible. También contamos con envíos expeditos para que tus impresiones lleguen a ti incluso más rápido."}],WHAT_IF_WRONG_ORDER_QUESTION:[{type:0,value:"¿Qué pasa si hay algún problema con mi pedido?"}],WHAT_IF_WRONG_ORDER_ANSWER:[{type:0,value:'Si no estás satisfecho con tus impresiones o cuadros decorativos, Flickr se encargará de corregir el problema. Simplemente envíanos un correo electrónico dentro de los 30 días posteriores a la fecha en que recibiste tu pedido y te ayudaremos. Si tienes algún problema, <a class="support-link" href="'},{type:1,value:"supportUrl"},{type:0,value:'" target="_blank">ponte en contacto con nuestros Héroes de soporte</a>.'}],WHERE_PHOTO_BOOK_QUESTION:[{type:0,value:"¿Dónde puedo hacer un álbum de fotos?"}],WHERE_PHOTO_BOOK_ANSWER:[{type:0,value:"Estamos asociados con Blurb y Chatbooks para crear  álbumes de fotos con tapas duras y suaves. Tu galería de fotos de Flickr y álbumes están integrados perfectamente en el proceso de creación de los álbumes.  Dale un vistazo a los álbumes de fotos."}],WHERE_PHOTO_BOOK_ANSWER_WITH_LINKS:[{type:0,value:'Somos socios de <a class="blurb-link" href="'},{type:1,value:"blurbUrl"},{type:0,value:'" target="_blank">Blurb</a> tanto para álbumes de fotos de tapa dura como de tapa blanda. Las fotos y álbumes de Flickr se integran a la perfección en el proceso de creación de los álbumes.<a class="photo-books-link" href="'},{type:1,value:"photoBooksUrl"},{type:0,value:'" target="_blank">Échale un vistazo a nuestros álbumes de fotos.</a>'}],MORE_QUESTIONS_QUESTION:[{type:0,value:"¿Tienes más preguntas?"}],MORE_QUESTIONS_ANSWER:[{type:0,value:'Visita el <a class="help-link" href="'},{type:1,value:"helpUrl"},{type:0,value:'" target="_blank">Centro de ayuda de Flickr</a> para obtener más información o para ponerte en contacto con un Héroe de soporte.'}],PREPARING_YOUR_PHOTO:[{type:0,value:"Estamos preparando tu foto..."}],SOMETHING_WRONG_PREPARING_PRINT:[{type:0,value:"Algo salió mal mientras preparábamos tu foto para imprimirla."}],MID_PAGE_PHOTO_ATTRIBUTION:[{type:0,value:"Foto de "},{type:1,value:"photoOwner"},{type:0,value:".."}],UNSUPPORTED_FILE_TYPE_PLEASE_JPG:[{type:0,value:"Este tipo de archivo no es compatible. Usa archivos JPG para imprimir."}],PRINT_PHOTOS_WITH_EASE:[{type:0,value:"Imprime fácilmente tus fotos favoritas en los mejores laboratorios."}]})}),"@VERSION@",{requires:["intl"]});YUI.add("photo-prints-helper",(function(e,r){var t=require("url-parse"),i=require("hermes-core/flog")(r),n=require("superagent"),s=e.mix({langBundles:["prints"]},e.Localizable),o={default:"prints.SOMETHING_WRONG_PREPARING_PRINT",4:"prints.UNSUPPORTED_FILE_TYPE_PLEASE_JPG"};e.PhotoPrintsHelper=function(r){var a=e.config.flickr.flickrprints.devBaseUrl,l=e.config.flickr.flickrprints.baseUrl,c=e.config.flickr.flickrprints.cartPath,p=e.config.flickr.flickrprints.devApiKey,u=e.config.flickr.flickrprints.apiKey;return{isPrintsEnabled:function(){return r.getViewer().signedIn||!r.getViewer().signedIn&&r.flipper.isFlipped("enable-others-to-print")},canPrintPhoto:function(e){return this.isPrintsEnabled()&&!e.getValue("isVideo")&&(e.getValue("isOwner")||r.flipper.isFlipped("enable-others-to-print")&&!e.getValue("isOwner")&&e.getValue("engagement").getValue("canPrint"))},registerPrint:function(t,i){var n=this;return r.callAPI("flickr.printservice.getRedirectURL",{user_id:t.getValue("owner").getValue("id"),photo_id:t.getValue("id"),return_url:i}).then((function(r){return n.isPrintUrlSafe(r.redirectURL)?{redirectURL:r.redirectURL}:e.Promise.reject({message:n.getRegisterPrintErrorCodeMessage()})})).catch((function(e){throw{message:n.getRegisterPrintErrorCodeMessage(e.code)}}))},isPrintUrlSafe:function(e){var r=new t(e);return"https:"===r.protocol&&"https://"+r.hostname===this.getBaseUrl()},getBaseUrl:function(){return r.flipper.isFlipped("enable-photo-prints-prod-url")?l:a},getApiKey:function(){return r.flipper.isFlipped("enable-photo-prints-prod-url")?u:p},getCartUrl:function(){return this.getBaseUrl()+c},fetchCartCount:function(){var e=this.getBaseUrl()+"/api/v2/cart?APIKey="+this.getApiKey();return n.get(e).withCredentials().set("Accept","application/json").then((function(e){return{count:e&&e.body.Response.Cart?e.body.Response.Cart.ItemCount:0}})).catch((function(e){throw i.error("Error fetching cart count",{err:e}),e}))},fetchOrder:function(e){var r=this.getBaseUrl()+"/api/v2/order/"+e+"?_expand=OrderBillingAddress&APIKey="+this.getApiKey();return n.get(r).withCredentials().set("Accept","application/json").then((function(r){var t="/api/v2/order/"+e+"!billingaddress",i=r.body.Response.Order,n=r.body.Expansions[t];return{orderId:i.OrderID,orderUrl:i.WebUri,email:n.OrderBillingAddress.Email}}))},getRegisterPrintErrorCodeMessage:function(e){var r=e?e.toString():"";return o.hasOwnProperty(r)?s.intlMessage({intlName:o[r]}):s.intlMessage({intlName:o.default})}}}}),"@VERSION@",{requires:[]});YUI.add("print-button-view",(function(t,i){require("hermes-core/flog")(i);t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){this.params=i,this.disableClicks=i.disableClicks,this.iconSize=void 0!==i.iconSize?i.iconSize:"normal",this.photoPrintsHelper=new t.PhotoPrintsHelper(this.appContext),this.selectors={printButton:".print-button-container .print-button",newLabel:".print-button-container .label-beta"}},loadState:function(){var t=this;return this.appContext.getModel("photo-models",this.params.photoId).then((function(i){t.photoModel=i}))},buildContainer:function(){this.setContainerWithTemplate("print-button",{iconSize:this.iconSize})},activate:function(){var t=this.get("container");this.printButtonNode=t.one(this.selectors.printButton),this.printNewLabelNode=t.one(this.selectors.newLabel),this.disableClicks||(this.printButtonNode&&this.registerEventHandler(this.printButtonNode.on("click",this.handlePrintClick.bind(this))),this.printNewLabelNode&&this.registerEventHandler(this.printNewLabelNode.on("click",this.showPrintTooltip.bind(this))))},handlePrintClick:function(){"en-us"===this.appContext.lang.toLowerCase()?this.preparePrint():this.showEnglishWarningModal()},preparePrint:function(){var i=this;this.showPreparingPrintModal(),this.photoPrintsHelper.registerPrint(this.photoModel,t.config.win.location.href).then((function(i){t.config.win.location.href=i.redirectURL})).catch((function(t){i.preparePrintModalSubview.showError(t.message||i.intlMessage({intlName:"prints.SOMETHING_WRONG_PREPARING_PRINT"}))}))},showEnglishWarningModal:function(i){var e=this;this.englishWarningModal=new t.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,showActionButton:!0,actionButtonLabel:this.intlMessage({intlName:"prints.CONTINUE_IN_ENGLISH"}),showCancelButton:!0,cancelButtonLabel:"en-us"===this.appContext.lang.toLowerCase()?this.intlMessage({intlName:"common.GO_BACK_BUTTON"}):this.intlMessage({intlName:"common.CANCEL"}),showCancelX:!1,showHeader:!0,showFooter:!0,title:this.intlMessage({intlName:"prints.ENGLISH_LANGUAGE_AHEAD"}),message:this.intlMessage({intlName:"prints.ORDERING_IS_ENGLISH_ONLY"}),hideModalOverlay:!1}),this.englishWarningModal.show(),this.englishWarningModal.on("actionClick",(function(){e.englishWarningModal.close(),setTimeout((function(){e.preparePrint()}),0)}))},showPreparingPrintModal:function(){var i=this;this.preparePrintModalSubview=new t.Views["prepare-print-modal-view"]({appContext:this.appContext}),this.preparingPrintModal=new t.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,showActionButton:!1,showCancelButton:!1,showCancelX:!1,showHeader:!1,showFooter:!1,subview:this.preparePrintModalSubview,hideModalOverlay:!1,contentPadding:0}),this.preparingPrintModal.show(),this.preparePrintModalSubview.on("retryClicked",(function(){i.preparingPrintModal.close(),setTimeout((function(){i.preparePrint()}),0)})),this.preparePrintModalSubview.on("closeClicked",(function(){i.preparingPrintModal.close()}))},showPrintTooltip:function(){var i,e=this,n=this.printButtonNode;n&&(this.tooltip=new t.Views.FluidDroparound({appContext:this.appContext,htmlMessage:this.templates("print-icon-tooltip")({}),showDropArrow:!0,dismissOnOverlayClick:!0,observePageResize:!0,anchorElement:n,keyboardAnchorElement:n,minVerticalSpace:400,width:300,positionFixed:!0,preferLeft:!0,closeOnScroll:!0,anchorOffsetVertical:0}),i=this.tooltip.get("container"),this.registerEventHandler(i.delegate("click",(function(t){e.tooltip.close()}),".close-x-button")),this.tooltip.show())}})}),"@VERSION@",{requires:["flickr-view","hermes-template-print-button","hermes-template-print-icon-tooltip","prepare-print-modal-view","photo-prints-helper"],optional:["photo-models"],langBundles:["common","prints"]});YUI.add("photo-card-helper",(function(e,t){e.mix({langBundles:["common","feed","feed-new"]},e.Localizable);var a=require("justified-layout");e.PhotoCardHelper=function(t){var o={layoutValues:{large:{BATCH_CARD_SPACING:4,BATCH_TARGET_ROW_HEIGHT:150,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3,BATCH_ROW_HEIGHT_RATIO:.5},medium:{BATCH_CARD_SPACING:4,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3},compact:{BATCH_CARD_SPACING:8,BATCH_TARGET_ROW_HEIGHT:180,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3,SINGLE_PHOTO_HEIGHT:250}},ATTRIBUTION_HEADER_HEIGHT:58,DETAILS_FOOTER_HEIGHT:70,INFO_BAR_HEIGHT:52,MAX_PHOTO_AR:2.5,MIN_PHOTO_AR:.5,MANUAL_PORTRAIT_AR:.75,MANUAL_LANDSCAPE_AR:2,getCappedPhotoHeight:function(e){e.height;return Math.min(e.height,Math.max(t.viewportData.getHeight()*e.viewportProportion-e.additionalCardHeight,e.minHeight))},getClampedPhotoAspectRatio:function(e){return Math.min(Math.max(e,this.MIN_PHOTO_AR),this.MAX_PHOTO_AR)},generateCompactBatchLayout:function(e){var t,o,i=this,n=1===e.photoItems.length?this.layoutValues.compact.SINGLE_PHOTO_HEIGHT:this.layoutValues.compact.BATCH_TARGET_ROW_HEIGHT;t=e.photoItems.map((function(e){return i.getClampedPhotoAspectRatio(e.aspectRatio)})),(o=a(t,{containerWidth:e.width,containerPadding:0,boxSpacing:{horizontal:this.layoutValues.compact.BATCH_CARD_SPACING,vertical:this.layoutValues.compact.BATCH_CARD_SPACING},targetRowHeight:n,targetRowHeightTolerance:this.layoutValues.compact.BATCH_TARGET_ROW_HEIGHT_TOLERANCE})).width=e.width;var u=o.boxes[0].top,l=[0],s=0;return o.boxes.some((function(e,t){if(e.top>u){if(s+=o.boxes[l[l.length-1]].height+i.layoutValues.compact.BATCH_CARD_SPACING,l.push(t),l.length>3)return!0;u=e.top}})),l.length>3&&(o.boxes=o.boxes.slice(0,l[l.length-1]),o.containerHeight=s),o},generateThreeMaxLayout:function(e){var a=this,o={},i=[],n=[],u=e.photoItems.length;return 2===(n=(n=e.photoItems.map((function(e){return a.getClampedPhotoAspectRatio(e.aspectRatio)}))).slice(0,3)).length?n[0]>1&&n[1]>1?(i.push(n.slice(0,1)),i.push(n.slice(1,2)),o=this.buildCustomRowsLayout(i,e)):(i.push(n.slice(0,2)),o=this.buildCustomRowsLayout(i,e)):3===n.length&&(n[0]>1&&n[1]>1&&n[2]>1||n[0]>1&&n[1]>1&&n[2]<=1||n[0]>1&&n[1]<=1&&n[2]>1||n[0]>1&&n[1]<=1&&n[2]<=1?(i.push(n.slice(0,1)),i.push(n.slice(1,3)),o=this.buildCustomRowsLayout(i,e)):n[0]<=1&&n[1]>1&&n[2]>1?(u>3?i.push(n.slice(0,2)):(i.push(n.slice(0,2)),i.push(n.slice(2,3))),o=this.buildCustomRowsLayout(i,e)):n[0]<=1&&n[1]>1&&n[2]<=1?(i.push(n.slice(0,2)),o=this.buildCustomRowsLayout(i,e)):n[0]<=1&&n[1]<=1&&n[2]>1?(u>3?i.push(n.slice(0,2)):(i.push(n.slice(0,2)),i.push(n.slice(2,3))),o=this.buildCustomRowsLayout(i,e)):n[0]<=1&&n[1]<=1&&n[2]<=1&&(i.push(n.slice(0,3)),o=this.buildCustomRowsLayout(i,e))),Math.max.apply(Math,o.boxes.map((function(e){return e.height})))>.8*t.viewportData.getHeight()&&((i=[]).push(n.slice(0,2)),o=this.buildCustomRowsLayout(i,e)),o},buildCustomRowsLayout:function(e,t){var a=this,o=0,i={boxes:[]};return e.forEach((function(n,u){var l={horizontal:a.layoutValues.large.BATCH_CARD_SPACING,vertical:a.layoutValues.large.BATCH_CARD_SPACING},s=a.generateCustomJustifiedRow(n,{containerWidth:t.width,padding:l.horizontal,top:0===u?0:o});i.boxes=i.boxes.concat(s),o+=u!==e.length-1?s[0].height+l.vertical:s[0].height})),i.containerHeight=o,i},generateCustomJustifiedRow:function(e,t){var a=e.reduce((function(e,t,a){return e+t}),0),o=(t.containerWidth-t.padding*(e.length-1))/a,i=0;return e.map((function(e,a){var n=i;return i+=o*e+t.padding,{aspectRatio:e,width:o*e,height:o,left:n,top:t.top}}))},scaleLayout:function(e,t,a,o,i){var n,u=0,l=0,s=[];return e.boxes.forEach((function(e,a){o||(e.width*=t,e.left*=t),i||(e.height*=t,e.top*=t)})),s.push([]),e.boxes.forEach((function(e,t){e.top>l&&(u++,l=e.top,s.push([])),s[u].push(e)})),n=0,s.forEach((function(u,l){var r=a,h=r*t,g=0;u.forEach((function(e,t){o||(e.width-=(r-h)*(u.length-1)/u.length,e.left=g+t*r,g+=e.width),i||(e.height-=(r-h)*(s.length-1)/s.length,e.top=n+l*r,t===u.length-1&&(n+=u[0].height))})),o||(e.width=g+(u.length-1)*r)})),i||(e.containerHeight=n+(s.length-1)*a),e},convertPhotoModel:function(t){var a,o=t.getValue("owner"),i=t.getValue("engagement"),n=o.getValue("isPro");return"photo-lite-models"===t.registry.name?(a=this.convertEngagementModel(t),{id:e.guid(),layoutRenderType:"photo",photoId:t.getValue("id"),aspectRatio:t.getValue("aspectRatio"),sizes:t.getValue("sizes"),url:t.getValue("url"),title:t.getValue("title"),description:t.getValue("description"),mediaType:t.getValue("mediaType"),isVideo:t.getValue("isVideo"),owner:{nsid:o.getValue("nsid"),url:o.getValue("url"),displayname:o.getValue("displayname"),pathAlias:o.getValue("pathAlias"),isPro:n,proBadgeType:n?o.getValue("proBadge"):void 0,model:t.getValue("owner")},engagement:a,isOwner:t.getValue("isOwner"),needsInterstitial:t.getValue("needsInterstitial"),model:t,engagementModel:i}):(a=this.convertEngagementModel(i),{id:e.guid(),layoutRenderType:"photo",photoId:t.getValue("id"),aspectRatio:t.getValue("aspectRatio"),sizes:t.getValue("sizes"),url:t.getValue("url"),title:t.getValue("title"),description:t.getValue("description"),mediaType:t.getValue("mediaType"),isVideo:t.getValue("isVideo"),owner:{nsid:o.getValue("nsid"),url:o.getValue("url"),displayname:o.getValue("displayname"),buddyicon:o.getValue("buddyicon"),pathAlias:o.getValue("pathAlias"),isPro:n,proBadgeType:n?o.getValue("proBadge"):void 0,model:t.getValue("owner")},engagement:a,isOwner:t.getValue("isOwner"),needsInterstitial:t.getValue("needsInterstitial"),safetyLevel:t.getValue("safetyLevel"),model:t,engagementModel:i})},convertEngagementModel:function(e){return"photo-lite-models"===e.registry.name?{photoId:e.getValue("id"),isFaved:e.getValue("isFaved"),faveCount:e.getValue("faveCount"),commentCount:e.getValue("commentCount"),canFave:e.getValue("canFave"),reactions:t.flipper.isFlipped("enable-likes")?e.getValue("reactions"):void 0,model:e}:{photoId:e.getValue("id"),isFaved:e.getValue("isFaved"),faveCount:e.getValue("faveCount"),commentCount:e.getValue("commentCount"),viewCount:e.getValue("viewCount"),canFave:e.getValue("canFave"),reactions:t.flipper.isFlipped("enable-likes")?e.getValue("reactions"):void 0,model:e}}};return e.augment(o,e.EventTarget),o}}),"@VERSION@",{requires:["event-custom","storage-helper"]});